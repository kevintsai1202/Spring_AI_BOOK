# 5.8 Function Calling (ä¸‹) - æœ€çµ‚çµ„åˆæŠ€

> **æœ¬ç« é‡é»**ï¼šæŒæ¡ Function Calling çš„é€²éšæŠ€å·§ï¼ŒåŒ…æ‹¬å·¥å…·éˆå¼èª¿ç”¨ã€æ¢ä»¶å¼åŸ·è¡Œå’Œè¤‡é›œæ¥­å‹™é‚è¼¯çš„å¯¦ç¾ï¼Œå»ºç«‹ä¼æ¥­ç´šçš„æ™ºèƒ½å·¥å…·ç”Ÿæ…‹ç³»çµ±ã€‚

## ğŸ¯ å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬ç« å­¸ç¿’å¾Œï¼Œæ‚¨å°‡èƒ½å¤ ï¼š

- ğŸ¯ **æŒæ¡å·¥å…·éˆèª¿ç”¨**ï¼šç†è§£ AI å¦‚ä½•è‡ªå‹•é€²è¡Œå¤šå±¤æ¬¡å·¥å…·èª¿ç”¨
- ğŸ¯ **å¯¦ç¾æ¢ä»¶å¼åŸ·è¡Œ**ï¼šæ ¹æ“šä¸åŒæ¢ä»¶æ™ºèƒ½é¸æ“‡å’Œçµ„åˆå·¥å…·
- ğŸ¯ **è¨­è¨ˆè¤‡é›œå·¥å…·éˆ**ï¼šå»ºç«‹å¤šæ­¥é©Ÿçš„æ¥­å‹™æµç¨‹è‡ªå‹•åŒ–
- ğŸ¯ **å„ªåŒ–å·¥å…·æ•ˆèƒ½**ï¼šæŒæ¡å·¥å…·èª¿ç”¨çš„æ•ˆèƒ½å„ªåŒ–å’Œæˆæœ¬æ§åˆ¶
- ğŸ¯ **å»ºç«‹å·¥å…·ç”Ÿæ…‹**ï¼šè¨­è¨ˆå¯æ“´å±•çš„ä¼æ¥­ç´šå·¥å…·ç®¡ç†ç³»çµ±

---

## 5.8.1 è®“ AI è‡ªå·±èª¿ç”¨ç¨‹å¼

### Function Calling çš„é€²éšç‰¹æ€§

![AI è‡ªå‹•èª¿ç”¨](https://ithelp.ithome.com.tw/upload/images/20240812/20161290El6Y5FmnHN.png)

åŸæœ¬ Function Call åªæ‰“ç®—å¯«å…©ç¯‡ï¼Œä¸éæœ€è¿‘åƒè€ƒå…¶ä»–æ¡†æ¶ç™¼ç¾ **Function Calling æ˜¯æœƒè¢«åè¦†èª¿ç”¨çš„**ï¼Œæ¸¬è©¦å¾Œç™¼ç¾ Spring AI ä¹Ÿæœ‰é¡ä¼¼çš„æ•ˆæœã€‚

Spring AI æœƒå…ˆå»èª¿ç”¨ç¬¦åˆçš„ Function ä¸¦å–å¾—è³‡æ–™ï¼Œä¹‹å¾Œæœƒå†æ‹¿å–å¾—çš„è³‡æ–™ç¢ºèªæ˜¯å¦é‚„æœ‰å¯åŒ¹é…çš„ Functionï¼Œä¸¦å°‡ç›®å‰å–å¾—çš„çµæœå†æ¬¡å‘¼å« Functionã€‚

### å·¥å…·éˆèª¿ç”¨çš„æ ¸å¿ƒæ¦‚å¿µ

**1. è‡ªå‹•éˆå¼èª¿ç”¨**
- ğŸ”— **æ™ºèƒ½ä¸²è¯**ï¼šAI è‡ªå‹•åˆ¤æ–·éœ€è¦èª¿ç”¨å“ªäº›å·¥å…·
- ğŸ“Š **è³‡æ–™æµè½‰**ï¼šå‰ä¸€å€‹å·¥å…·çš„è¼¸å‡ºæˆç‚ºä¸‹ä¸€å€‹å·¥å…·çš„è¼¸å…¥
- ğŸ¯ **ç›®æ¨™å°å‘**ï¼šAI æŒçºŒèª¿ç”¨å·¥å…·ç›´åˆ°æ»¿è¶³ä½¿ç”¨è€…éœ€æ±‚
- ğŸ”„ **è¿­ä»£å„ªåŒ–**ï¼šæ ¹æ“šä¸­é–“çµæœèª¿æ•´å¾ŒçºŒèª¿ç”¨ç­–ç•¥

**2. å‚³çµ±æ–¹å¼ vs å·¥å…·éˆæ–¹å¼**

| æ¯”è¼ƒé …ç›® | å‚³çµ±å–®ä¸€å·¥å…· | å·¥å…·éˆèª¿ç”¨ |
|----------|-------------|------------|
| **è³‡æ–™è™•ç†** | ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰è³‡æ–™ | æŒ‰éœ€ç²å–ï¼Œåˆ†æ­¥è™•ç† |
| **æˆæœ¬æ§åˆ¶** | é«˜ï¼ˆå‚³è¼¸å¤§é‡è³‡æ–™ï¼‰ | ä½ï¼ˆæŒ‰éœ€èª¿ç”¨ï¼‰ |
| **éˆæ´»æ€§** | ä½ï¼ˆå›ºå®šè³‡æ–™çµæ§‹ï¼‰ | é«˜ï¼ˆå‹•æ…‹çµ„åˆï¼‰ |
| **ç¶­è­·æ€§** | è¤‡é›œï¼ˆå–®ä¸€å·¥å…·æ‰¿æ“”å¤šè²¬ä»»ï¼‰ | ç°¡å–®ï¼ˆè·è²¬åˆ†é›¢ï¼‰ |
| **æ“´å±•æ€§** | å›°é›£ï¼ˆä¿®æ”¹å½±éŸ¿å…¨å±€ï¼‰ | å®¹æ˜“ï¼ˆç¨ç«‹å·¥å…·æ¨¡çµ„ï¼‰ |

**3. å·¥å…·éˆèª¿ç”¨çš„å„ªå‹¢**

```
âŒ å‚³çµ±æ–¹å¼ï¼š
ç”¨æˆ¶æŸ¥è©¢ â†’ å–®ä¸€å¤§å‹å·¥å…· â†’ è¿”å›æ‰€æœ‰ç›¸é—œè³‡æ–™ â†’ AI åˆ†æ

âœ… å·¥å…·éˆæ–¹å¼ï¼š
ç”¨æˆ¶æŸ¥è©¢ â†’ å·¥å…·Aï¼ˆåŸºç¤è³‡æ–™ï¼‰ â†’ å·¥å…·Bï¼ˆè©³ç´°è³‡è¨Šï¼‰ â†’ å·¥å…·Cï¼ˆåˆ†æè¨ˆç®—ï¼‰ â†’ AI æ•´åˆå›æ‡‰
```

---

## 5.8.2 è¤‡é›œå·¥å…·éˆå¯¦ç¾

### ç¨‹å¼ç›®æ¨™è¨­å®š

**å¯¦æˆ°å ´æ™¯**ï¼šè©¢å• AI å…¬å¸å»å¹´æœ€ç†±éŠ·çš„ç”¢å“ï¼Œä¸¦åˆ—å‡ºè©²ç”¢å“æ‰€æœ‰å‹è™Ÿ

**å·¥å…·éˆæµç¨‹**ï¼š
1. ğŸ” **éŠ·å”®æŸ¥è©¢å·¥å…·** â†’ ç²å–å»å¹´æ‰€æœ‰ç”¢å“éŠ·å”®è³‡æ–™
2. ğŸ“Š **è³‡æ–™åˆ†æå·¥å…·** â†’ æ‰¾å‡ºæœ€ç†±éŠ·ç”¢å“
3. ğŸ” **ç”¢å“è©³æƒ…å·¥å…·** â†’ æŸ¥è©¢è©²ç”¢å“çš„æ‰€æœ‰å‹è™Ÿ
4. ğŸ§® **è¨ˆç®—å·¥å…·** â†’ é€²è¡Œç›¸é—œçµ±è¨ˆè¨ˆç®—
5. ğŸ¯ **AI æ•´åˆ** â†’ ç”Ÿæˆå®Œæ•´åˆ†æå ±å‘Š

### ç”¢å“è©³æƒ…å·¥å…·å¯¦ç¾

**æ­¥é©Ÿ 1ï¼šç”¢å“å‹è™ŸæŸ¥è©¢å·¥å…·**

```java
package com.example.tools;

import lombok.extern.slf4j.Slf4j;
import org.springframework.ai.tool.annotation.Tool;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;

@Component
@Slf4j
public class ProductDetailsTools {
    
    /**
     * ç”¢å“è©³æƒ…è³‡æ–™æ¨¡å‹
     */
    public record ProductDetail(
            String product,
            String productName,
            List<String> models,
            String category,
            String description
    ) {}
    
    /**
     * ç”¢å“å‹è™Ÿè³‡æ–™æ¨¡å‹
     */
    public record ProductModel(
            String modelCode,
            String modelName,
            String specifications,
            String price,
            String availability
    ) {}
    
    /**
     * æ ¹æ“šç”¢å“åç¨±ç²å–ç”¢å“å‹è™Ÿåˆ—è¡¨
     * @param product ç”¢å“ä»£ç¢¼æˆ–åç¨±
     * @return ç”¢å“è©³æƒ…åŒ…å«æ‰€æœ‰å‹è™Ÿ
     */
    @Tool(description = "Get detailed product information including all available models by product code or name. " +
          "Returns comprehensive product details with model specifications.")
    public ProductDetail getProductModels(String product) {
        try {
            log.info("æŸ¥è©¢ç”¢å“å‹è™Ÿï¼š{}", product);
            
            // æ¨¡æ“¬ä¼æ¥­ç”¢å“è³‡æ–™åº«
            Map<String, ProductDetail> productDatabase = Map.of(
                "PD-1405", new ProductDetail(
                    "PD-1405",
                    "æ™ºèƒ½æ‰‹æ©Ÿ Pro ç³»åˆ—",
                    List.of("1405-001", "1405-002", "1405-003", "1405-004"),
                    "æ™ºèƒ½æ‰‹æ©Ÿ",
                    "é«˜ç«¯æ™ºèƒ½æ‰‹æ©Ÿç³»åˆ—ï¼Œæ”¯æ´ 5G å’Œ AI æ”å½±"
                ),
                "PD-1234", new ProductDetail(
                    "PD-1234",
                    "ç­†è¨˜å‹é›»è…¦ Ultra ç³»åˆ—",
                    List.of("1234-1", "1234-2", "1234-3", "1234-4", "1234-5"),
                    "ç­†è¨˜å‹é›»è…¦",
                    "è¼•è–„é«˜æ•ˆèƒ½ç­†è¨˜å‹é›»è…¦ï¼Œé©åˆå•†å‹™å’Œå‰µä½œ"
                ),
                "PD-1235", new ProductDetail(
                    "PD-1235",
                    "å¹³æ¿é›»è…¦ç³»åˆ—",
                    List.of("1235-4", "1235-5", "1235-6"),
                    "å¹³æ¿é›»è…¦",
                    "å¤šåŠŸèƒ½å¹³æ¿é›»è…¦ï¼Œæ”¯æ´æ‰‹å¯«ç­†å’Œéµç›¤"
                ),
                "PD-1385", new ProductDetail(
                    "PD-1385",
                    "æ™ºèƒ½æ‰‹éŒ¶ç³»åˆ—",
                    List.of("1385-1", "1385-2", "1385-3", "1385-4"),
                    "ç©¿æˆ´è£ç½®",
                    "å¥åº·ç›£æ¸¬æ™ºèƒ½æ‰‹éŒ¶ï¼Œæ”¯æ´é‹å‹•è¿½è¹¤å’Œå¿ƒç‡ç›£æ¸¬"
                ),
                "PD-1255", new ProductDetail(
                    "PD-1255",
                    "ç„¡ç·šè€³æ©Ÿç³»åˆ—",
                    List.of("1255-1", "1255-2"),
                    "éŸ³éŸ¿è¨­å‚™",
                    "ä¸»å‹•é™å™ªç„¡ç·šè€³æ©Ÿï¼Œé«˜å“è³ªéŸ³æ•ˆé«”é©—"
                ),
                "PD-1300", new ProductDetail(
                    "PD-1300",
                    "æ™ºèƒ½éŸ³ç®±ç³»åˆ—",
                    List.of("1300-1", "1300-2", "1300-3"),
                    "æ™ºèƒ½å®¶å±…",
                    "AI èªéŸ³åŠ©æ‰‹æ™ºèƒ½éŸ³ç®±ï¼Œæ”¯æ´æ™ºèƒ½å®¶å±…æ§åˆ¶"
                )
            );
            
            ProductDetail result = productDatabase.get(product);
            if (result == null) {
                // å˜—è©¦æ¨¡ç³ŠåŒ¹é…
                result = productDatabase.values().stream()
                        .filter(pd -> pd.productName().toLowerCase().contains(product.toLowerCase()))
                        .findFirst()
                        .orElse(new ProductDetail(
                                product,
                                "æœªçŸ¥ç”¢å“",
                                List.of("ç„¡æ­¤ç”¢å“å‹è™Ÿ"),
                                "æœªåˆ†é¡",
                                "æŸ¥ç„¡æ­¤ç”¢å“è³‡è¨Š"
                        ));
            }
            
            log.info("æŸ¥è©¢å®Œæˆï¼Œç”¢å“ï¼š{}ï¼Œå‹è™Ÿæ•¸é‡ï¼š{}", 
                    result.productName(), result.models().size());
            
            return result;
            
        } catch (Exception e) {
            log.error("æŸ¥è©¢ç”¢å“å‹è™Ÿå¤±æ•—ï¼š{}", product, e);
            return new ProductDetail(
                    product,
                    "æŸ¥è©¢å¤±æ•—",
                    List.of("ç³»çµ±éŒ¯èª¤"),
                    "éŒ¯èª¤",
                    "æŸ¥è©¢ç”¢å“è³‡è¨Šæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š" + e.getMessage()
            );
        }
    }
    
    /**
     * ç²å–ç‰¹å®šå‹è™Ÿçš„è©³ç´°è¦æ ¼
     * @param productCode ç”¢å“ä»£ç¢¼
     * @param modelCode å‹è™Ÿä»£ç¢¼
     * @return å‹è™Ÿè©³ç´°è³‡è¨Š
     */
    @Tool(description = "Get detailed specifications for a specific product model. " +
          "Returns comprehensive model information including price and availability.")
    public ProductModel getModelSpecifications(String productCode, String modelCode) {
        try {
            log.info("æŸ¥è©¢å‹è™Ÿè¦æ ¼ï¼š{}-{}", productCode, modelCode);
            
            // æ¨¡æ“¬å‹è™Ÿè¦æ ¼è³‡æ–™åº«
            String fullModelCode = productCode + "-" + modelCode;
            
            // æ ¹æ“šç”¢å“é¡å‹ç”Ÿæˆè¦æ ¼è³‡è¨Š
            ProductModel model = switch (productCode) {
                case "PD-1405" -> new ProductModel(
                        modelCode,
                        "æ™ºèƒ½æ‰‹æ©Ÿ Pro " + modelCode,
                        generatePhoneSpecs(modelCode),
                        generatePrice("phone", modelCode),
                        "ç¾è²¨ä¾›æ‡‰"
                );
                case "PD-1234" -> new ProductModel(
                        modelCode,
                        "ç­†è¨˜å‹é›»è…¦ Ultra " + modelCode,
                        generateLaptopSpecs(modelCode),
                        generatePrice("laptop", modelCode),
                        "ç¾è²¨ä¾›æ‡‰"
                );
                case "PD-1385" -> new ProductModel(
                        modelCode,
                        "æ™ºèƒ½æ‰‹éŒ¶ " + modelCode,
                        generateWatchSpecs(modelCode),
                        generatePrice("watch", modelCode),
                        "ç¾è²¨ä¾›æ‡‰"
                );
                default -> new ProductModel(
                        modelCode,
                        "ç”¢å“å‹è™Ÿ " + modelCode,
                        "æ¨™æº–è¦æ ¼",
                        "åƒ¹æ ¼é¢è­°",
                        "è«‹æ´½è©¢"
                );
            };
            
            log.info("å‹è™Ÿè¦æ ¼æŸ¥è©¢å®Œæˆï¼š{}", model.modelName());
            return model;
            
        } catch (Exception e) {
            log.error("æŸ¥è©¢å‹è™Ÿè¦æ ¼å¤±æ•—ï¼š{}-{}", productCode, modelCode, e);
            return new ProductModel(
                    modelCode,
                    "æŸ¥è©¢å¤±æ•—",
                    "ç„¡æ³•ç²å–è¦æ ¼è³‡è¨Š",
                    "åƒ¹æ ¼æœªçŸ¥",
                    "æŸ¥è©¢éŒ¯èª¤"
            );
        }
    }
    
    private String generatePhoneSpecs(String modelCode) {
        return switch (modelCode) {
            case "1405-001" -> "6.1å‹ OLED è¢å¹•, 128GB å„²å­˜, é›™é¡é ­";
            case "1405-002" -> "6.1å‹ OLED è¢å¹•, 256GB å„²å­˜, ä¸‰é¡é ­";
            case "1405-003" -> "6.7å‹ OLED è¢å¹•, 512GB å„²å­˜, ä¸‰é¡é ­ Pro";
            case "1405-004" -> "6.7å‹ OLED è¢å¹•, 1TB å„²å­˜, å››é¡é ­ Pro Max";
            default -> "æ¨™æº–æ™ºèƒ½æ‰‹æ©Ÿè¦æ ¼";
        };
    }
    
    private String generateLaptopSpecs(String modelCode) {
        return switch (modelCode) {
            case "1234-1" -> "13å‹, Intel i5, 8GB RAM, 256GB SSD";
            case "1234-2" -> "13å‹, Intel i7, 16GB RAM, 512GB SSD";
            case "1234-3" -> "15å‹, Intel i7, 16GB RAM, 1TB SSD";
            case "1234-4" -> "15å‹, Intel i9, 32GB RAM, 1TB SSD";
            case "1234-5" -> "16å‹, Intel i9, 64GB RAM, 2TB SSD";
            default -> "æ¨™æº–ç­†è¨˜å‹é›»è…¦è¦æ ¼";
        };
    }
    
    private String generateWatchSpecs(String modelCode) {
        return switch (modelCode) {
            case "1385-1" -> "41mm, GPS, å¿ƒç‡ç›£æ¸¬";
            case "1385-2" -> "45mm, GPS, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬";
            case "1385-3" -> "41mm, GPS+Cellular, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬";
            case "1385-4" -> "45mm, GPS+Cellular, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬, ECG";
            default -> "æ¨™æº–æ™ºèƒ½æ‰‹éŒ¶è¦æ ¼";
        };
    }
    
    private String generatePrice(String category, String modelCode) {
        return switch (category) {
            case "phone" -> switch (modelCode) {
                case "1405-001" -> "NT$ 25,900";
                case "1405-002" -> "NT$ 29,900";
                case "1405-003" -> "NT$ 35,900";
                case "1405-004" -> "NT$ 42,900";
                default -> "NT$ 25,000";
            };
            case "laptop" -> switch (modelCode) {
                case "1234-1" -> "NT$ 35,900";
                case "1234-2" -> "NT$ 45,900";
                case "1234-3" -> "NT$ 55,900";
                case "1234-4" -> "NT$ 75,900";
                case "1234-5" -> "NT$ 95,900";
                default -> "NT$ 40,000";
            };
            case "watch" -> switch (modelCode) {
                case "1385-1" -> "NT$ 12,900";
                case "1385-2" -> "NT$ 15,900";
                case "1385-3" -> "NT$ 18,900";
                case "1385-4" -> "NT$ 22,900";
                default -> "NT$ 15,000";
            };
            default -> "åƒ¹æ ¼é¢è­°";
        };
    }
}
```

### å¢å¼·ç‰ˆéŠ·å”®å·¥å…·

**æ­¥é©Ÿ 2ï¼šéŠ·å”®è³‡æ–™åˆ†æå·¥å…·**

```java
package com.example.tools;

import lombok.extern.slf4j.Slf4j;
import org.springframework.ai.tool.annotation.Tool;
import org.springframework.stereotype.Component;

import java.math.BigDecimal;
import java.math.RoundingMode;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@Component
@Slf4j
public class EnhancedSalesTools {
    
    /**
     * ç”¢å“éŠ·å”®è³‡æ–™æ¨¡å‹
     */
    public record ProductSales(
            String product,
            String productName,
            int salesVolume,
            BigDecimal revenue,
            String category,
            double marketShare
    ) {}
    
    /**
     * éŠ·å”®æ’è¡Œè³‡æ–™æ¨¡å‹
     */
    public record SalesRanking(
            List<ProductSales> topProducts,
            ProductSales bestSeller,
            int totalVolume,
            BigDecimal totalRevenue,
            String analysisYear
    ) {}
    
    /**
     * ç²å–æŒ‡å®šå¹´ä»½çš„ç”¢å“éŠ·å”®è³‡æ–™
     * @param year æŸ¥è©¢å¹´ä»½
     * @return éŠ·å”®è³‡æ–™åˆ—è¡¨
     */
    @Tool(description = "Get comprehensive product sales data for a specific year. " +
          "Returns detailed sales information including volume, revenue, and market share.")
    public SalesRanking getProductSalesRanking(int year) {
        try {
            log.info("æŸ¥è©¢å¹´åº¦éŠ·å”®æ’è¡Œï¼š{}", year);
            
            List<ProductSales> salesData = getSalesDataByYear(year);
            
            if (salesData.isEmpty()) {
                return new SalesRanking(
                        List.of(),
                        null,
                        0,
                        BigDecimal.ZERO,
                        String.valueOf(year)
                );
            }
            
            // è¨ˆç®—ç¸½éŠ·é‡å’Œç¸½ç‡Ÿæ”¶
            int totalVolume = salesData.stream()
                    .mapToInt(ProductSales::salesVolume)
                    .sum();
            
            BigDecimal totalRevenue = salesData.stream()
                    .map(ProductSales::revenue)
                    .reduce(BigDecimal.ZERO, BigDecimal::add);
            
            // æŒ‰éŠ·é‡æ’åº
            List<ProductSales> topProducts = salesData.stream()
                    .sorted((p1, p2) -> Integer.compare(p2.salesVolume(), p1.salesVolume()))
                    .collect(Collectors.toList());
            
            ProductSales bestSeller = topProducts.get(0);
            
            SalesRanking ranking = new SalesRanking(
                    topProducts,
                    bestSeller,
                    totalVolume,
                    totalRevenue,
                    String.valueOf(year)
            );
            
            log.info("éŠ·å”®æ’è¡ŒæŸ¥è©¢å®Œæˆï¼š{}å¹´ï¼Œæœ€ä½³éŠ·å”®ç”¢å“ï¼š{}", 
                    year, bestSeller.productName());
            
            return ranking;
            
        } catch (Exception e) {
            log.error("æŸ¥è©¢éŠ·å”®æ’è¡Œå¤±æ•—ï¼š{}", year, e);
            throw new RuntimeException("æŸ¥è©¢éŠ·å”®æ’è¡Œå¤±æ•—ï¼š" + e.getMessage());
        }
    }
    
    /**
     * æ¯”è¼ƒä¸åŒç”¢å“çš„éŠ·å”®è¡¨ç¾
     * @param year æ¯”è¼ƒå¹´ä»½
     * @param products ç”¢å“ä»£ç¢¼åˆ—è¡¨
     * @return æ¯”è¼ƒçµæœ
     */
    @Tool(description = "Compare sales performance between multiple products in a specific year. " +
          "Returns detailed comparison with rankings and performance metrics.")
    public String compareProductPerformance(int year, List<String> products) {
        try {
            log.info("æ¯”è¼ƒç”¢å“éŠ·å”®è¡¨ç¾ï¼š{}å¹´ï¼Œç”¢å“ï¼š{}", year, products);
            
            List<ProductSales> allSales = getSalesDataByYear(year);
            
            List<ProductSales> targetProducts = allSales.stream()
                    .filter(sale -> products.contains(sale.product()))
                    .sorted((p1, p2) -> Integer.compare(p2.salesVolume(), p1.salesVolume()))
                    .collect(Collectors.toList());
            
            if (targetProducts.isEmpty()) {
                return "æœªæ‰¾åˆ°æŒ‡å®šç”¢å“çš„éŠ·å”®è³‡æ–™";
            }
            
            StringBuilder comparison = new StringBuilder();
            comparison.append(String.format("ğŸ“Š %då¹´ç”¢å“éŠ·å”®è¡¨ç¾æ¯”è¼ƒ\n\n", year));
            
            for (int i = 0; i < targetProducts.size(); i++) {
                ProductSales product = targetProducts.get(i);
                comparison.append(String.format(
                        "%d. %s (%s)\n" +
                        "   éŠ·å”®é‡ï¼š%,d å°\n" +
                        "   ç‡Ÿæ”¶ï¼š%s\n" +
                        "   å¸‚å ´å æœ‰ç‡ï¼š%.2f%%\n\n",
                        i + 1,
                        product.productName(),
                        product.product(),
                        product.salesVolume(),
                        formatCurrency(product.revenue()),
                        product.marketShare()
                ));
            }
            
            // æ·»åŠ åˆ†ææ´å¯Ÿ
            ProductSales winner = targetProducts.get(0);
            comparison.append("ğŸ† **åˆ†ææ´å¯Ÿ**\n");
            comparison.append(String.format(
                    "- æœ€ä½³è¡¨ç¾ï¼š%sï¼ŒéŠ·å”®é‡é ˜å…ˆ\n",
                    winner.productName()
            ));
            
            if (targetProducts.size() > 1) {
                ProductSales second = targetProducts.get(1);
                double gap = ((double) (winner.salesVolume() - second.salesVolume()) / second.salesVolume()) * 100;
                comparison.append(String.format(
                        "- é ˜å…ˆå„ªå‹¢ï¼šæ¯”ç¬¬äºŒåå¤š %.1f%%\n",
                        gap
                ));
            }
            
            log.info("ç”¢å“æ¯”è¼ƒå®Œæˆ");
            return comparison.toString();
            
        } catch (Exception e) {
            log.error("æ¯”è¼ƒç”¢å“éŠ·å”®è¡¨ç¾å¤±æ•—", e);
            return "æ¯”è¼ƒç”¢å“éŠ·å”®è¡¨ç¾å¤±æ•—ï¼š" + e.getMessage();
        }
    }
    
    private List<ProductSales> getSalesDataByYear(int year) {
        // æ¨¡æ“¬ä¸åŒå¹´ä»½çš„éŠ·å”®è³‡æ–™
        Map<Integer, List<ProductSales>> salesDatabase = Map.of(
            2023, List.of(
                new ProductSales("PD-1385", "æ™ºèƒ½æ‰‹éŒ¶ç³»åˆ—", 15000, 
                        new BigDecimal("300000000"), "ç©¿æˆ´è£ç½®", 35.7),
                new ProductSales("PD-1234", "ç­†è¨˜å‹é›»è…¦ Ultra ç³»åˆ—", 10000, 
                        new BigDecimal("800000000"), "ç­†è¨˜å‹é›»è…¦", 23.8),
                new ProductSales("PD-1405", "æ™ºèƒ½æ‰‹æ©Ÿ Pro ç³»åˆ—", 8500, 
                        new BigDecimal("425000000"), "æ™ºèƒ½æ‰‹æ©Ÿ", 20.2),
                new ProductSales("PD-1235", "å¹³æ¿é›»è…¦ç³»åˆ—", 1500, 
                        new BigDecimal("75000000"), "å¹³æ¿é›»è…¦", 3.6),
                new ProductSales("PD-1255", "ç„¡ç·šè€³æ©Ÿç³»åˆ—", 800, 
                        new BigDecimal("24000000"), "éŸ³éŸ¿è¨­å‚™", 1.9),
                new ProductSales("PD-1300", "æ™ºèƒ½éŸ³ç®±ç³»åˆ—", 500, 
                        new BigDecimal("15000000"), "æ™ºèƒ½å®¶å±…", 1.2)
            ),
            2024, List.of(
                new ProductSales("PD-1405", "æ™ºèƒ½æ‰‹æ©Ÿ Pro ç³»åˆ—", 18500, 
                        new BigDecimal("925000000"), "æ™ºèƒ½æ‰‹æ©Ÿ", 28.5),
                new ProductSales("PD-1385", "æ™ºèƒ½æ‰‹éŒ¶ç³»åˆ—", 17000, 
                        new BigDecimal("510000000"), "ç©¿æˆ´è£ç½®", 26.2),
                new ProductSales("PD-1234", "ç­†è¨˜å‹é›»è…¦ Ultra ç³»åˆ—", 12000, 
                        new BigDecimal("960000000"), "ç­†è¨˜å‹é›»è…¦", 18.5),
                new ProductSales("PD-1235", "å¹³æ¿é›»è…¦ç³»åˆ—", 8500, 
                        new BigDecimal("425000000"), "å¹³æ¿é›»è…¦", 13.1),
                new ProductSales("PD-1255", "ç„¡ç·šè€³æ©Ÿç³»åˆ—", 5500, 
                        new BigDecimal("165000000"), "éŸ³éŸ¿è¨­å‚™", 8.5),
                new ProductSales("PD-1300", "æ™ºèƒ½éŸ³ç®±ç³»åˆ—", 3500, 
                        new BigDecimal("105000000"), "æ™ºèƒ½å®¶å±…", 5.4)
            )
        );
        
        return salesDatabase.getOrDefault(year, List.of());
    }
    
    private String formatCurrency(BigDecimal amount) {
        if (amount.compareTo(new BigDecimal("100000000")) >= 0) {
            return String.format("NT$ %.1få„„", 
                    amount.divide(new BigDecimal("100000000"), 1, RoundingMode.HALF_UP).doubleValue());
        } else if (amount.compareTo(new BigDecimal("10000")) >= 0) {
            return String.format("NT$ %.0fè¬", 
                    amount.divide(new BigDecimal("10000"), 0, RoundingMode.HALF_UP).doubleValue());
        } else {
            return String.format("NT$ %,d", amount.intValue());
        }
    }
}
```

---

## 5.8.3 å·¥å…·éˆå”èª¿ç³»çµ±

### ChatClient é€²éšé…ç½®

```java
package com.example.config;

import com.example.tools.*;
import lombok.RequiredArgsConstructor;
import org.springframework.ai.chat.client.ChatClient;
import org.springframework.ai.chat.model.ChatModel;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
@RequiredArgsConstructor
public class AdvancedAiConfig {
    
    private final ProductDetailsTools productDetailsTools;
    private final EnhancedSalesTools enhancedSalesTools;
    private final DateTimeTools dateTimeTools;
    private final CalculatorTools calculatorTools;
    
    /**
     * ä¼æ¥­ç´šå·¥å…·éˆ ChatClient
     * æ”¯æ´è¤‡é›œçš„å¤šæ­¥é©Ÿå·¥å…·èª¿ç”¨
     */
    @Bean
    public ChatClient toolChainChatClient(ChatModel chatModel) {
        return ChatClient.builder(chatModel)
                .defaultTools(
                    enhancedSalesTools,     // éŠ·å”®è³‡æ–™åˆ†æå·¥å…·
                    productDetailsTools,    // ç”¢å“è©³æƒ…å·¥å…·
                    calculatorTools,        // è¨ˆç®—å·¥å…·
                    dateTimeTools          // æ™‚é–“å·¥å…·
                )
                .defaultSystem("""
                    ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ä¼æ¥­è³‡æ–™åˆ†æå°ˆå®¶ï¼Œæ“…é•·ä½¿ç”¨å¤šç¨®å·¥å…·é€²è¡Œæ·±åº¦åˆ†æã€‚
                    
                    å·¥å…·ä½¿ç”¨ç­–ç•¥ï¼š
                    1. æ ¹æ“šç”¨æˆ¶æŸ¥è©¢è‡ªå‹•é¸æ“‡åˆé©çš„å·¥å…·çµ„åˆ
                    2. æŒ‰é‚è¼¯é †åºèª¿ç”¨å·¥å…·ï¼ˆå…ˆç²å–åŸºç¤è³‡æ–™ï¼Œå†é€²è¡Œè©³ç´°åˆ†æï¼‰
                    3. å……åˆ†åˆ©ç”¨å·¥å…·éˆçš„å„ªå‹¢ï¼Œé¿å…ä¸€æ¬¡æ€§ç²å–éå¤šè³‡æ–™
                    4. æä¾›æ·±å…¥çš„åˆ†ææ´å¯Ÿå’Œå•†æ¥­å»ºè­°
                    
                    å¯ç”¨å·¥å…·ï¼š
                    - éŠ·å”®æ’è¡Œåˆ†æï¼šç²å–å¹´åº¦éŠ·å”®è³‡æ–™å’Œæ’è¡Œ
                    - ç”¢å“è©³æƒ…æŸ¥è©¢ï¼šç²å–ç”¢å“å‹è™Ÿå’Œè¦æ ¼è³‡è¨Š
                    - ç”¢å“æ¯”è¼ƒåˆ†æï¼šæ¯”è¼ƒå¤šå€‹ç”¢å“çš„éŠ·å”®è¡¨ç¾
                    - æ•¸å­¸è¨ˆç®—ï¼šé€²è¡Œå„ç¨®çµ±è¨ˆè¨ˆç®—
                    - æ™‚é–“æŸ¥è©¢ï¼šç²å–ç•¶å‰æ™‚é–“å’Œæ—¥æœŸè³‡è¨Š
                    
                    å›ç­”é¢¨æ ¼ï¼š
                    - ä½¿ç”¨å°ˆæ¥­ä½†æ˜“æ‡‚çš„èªè¨€
                    - æä¾›çµæ§‹åŒ–çš„åˆ†æçµæœ
                    - åŒ…å«å…·é«”çš„æ•¸æ“šå’Œæ´å¯Ÿ
                    - çµ¦å‡ºå¯¦ç”¨çš„å•†æ¥­å»ºè­°
                    """)
                .build();
    }
    
    /**
     * å¿«é€ŸæŸ¥è©¢ ChatClientï¼ˆç°¡åŒ–ç‰ˆï¼‰
     */
    @Bean("quickQueryChatClient")
    public ChatClient quickQueryChatClient(ChatModel chatModel) {
        return ChatClient.builder(chatModel)
                .defaultTools(
                    enhancedSalesTools,
                    dateTimeTools
                )
                .defaultSystem("ä½ æ˜¯ä¸€å€‹å¿«é€ŸæŸ¥è©¢åŠ©æ‰‹ï¼Œå°ˆé–€è™•ç†ç°¡å–®çš„è³‡æ–™æŸ¥è©¢è«‹æ±‚ã€‚")
                .build();
    }
}
```

### å·¥å…·éˆæ§åˆ¶å™¨

```java
package com.example.controller;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.ai.chat.client.ChatClient;
import org.springframework.web.bind.annotation.*;

import java.time.LocalDateTime;
import java.util.List;
import java.util.Map;

@RestController
@RequestMapping("/api/tool-chain")
@RequiredArgsConstructor
@Slf4j
public class ToolChainController {
    
    private final ChatClient toolChainChatClient;
    
    /**
     * è¤‡é›œå·¥å…·éˆæŸ¥è©¢
     * @param prompt è‡ªç„¶èªè¨€æŸ¥è©¢
     * @return AI åˆ†æçµæœ
     */
    @GetMapping("/complex-query")
    public String complexQuery(@RequestParam String prompt) {
        try {
            log.info("æ”¶åˆ°è¤‡é›œå·¥å…·éˆæŸ¥è©¢ï¼š{}", prompt);
            
            long startTime = System.currentTimeMillis();
            
            String response = toolChainChatClient
                    .prompt(prompt)
                    .call()
                    .content();
            
            long endTime = System.currentTimeMillis();
            
            log.info("è¤‡é›œæŸ¥è©¢å®Œæˆï¼Œè€—æ™‚ï¼š{}msï¼Œå›æ‡‰é•·åº¦ï¼š{} å­—å…ƒ", 
                    endTime - startTime, response.length());
            
            return response;
            
        } catch (Exception e) {
            log.error("è¤‡é›œå·¥å…·éˆæŸ¥è©¢å¤±æ•—ï¼š{}", prompt, e);
            return "æŸ¥è©¢å¤±æ•—ï¼š" + e.getMessage();
        }
    }
    
    /**
     * ç”¢å“æ·±åº¦åˆ†æ
     * @param request åˆ†æè«‹æ±‚
     * @return è©³ç´°åˆ†æå ±å‘Š
     */
    @PostMapping("/product-analysis")
    public ProductAnalysisResponse productAnalysis(@RequestBody ProductAnalysisRequest request) {
        try {
            log.info("ç”¢å“æ·±åº¦åˆ†æè«‹æ±‚ï¼š{}", request);
            
            long startTime = System.currentTimeMillis();
            
            // æ§‹å»ºåˆ†ææç¤ºè©
            String prompt = buildAnalysisPrompt(request);
            
            String analysis = toolChainChatClient
                    .prompt(prompt)
                    .call()
                    .content();
            
            long endTime = System.currentTimeMillis();
            
            return ProductAnalysisResponse.builder()
                    .success(true)
                    .productCode(request.getProductCode())
                    .analysisType(request.getAnalysisType())
                    .analysis(analysis)
                    .executionTime(endTime - startTime)
                    .timestamp(LocalDateTime.now())
                    .build();
            
        } catch (Exception e) {
            log.error("ç”¢å“æ·±åº¦åˆ†æå¤±æ•—", e);
            
            return ProductAnalysisResponse.builder()
                    .success(false)
                    .productCode(request.getProductCode())
                    .error(e.getMessage())
                    .timestamp(LocalDateTime.now())
                    .build();
        }
    }
    
    /**
     * å·¥å…·éˆåŸ·è¡Œè¿½è¹¤
     * @param prompt æŸ¥è©¢å…§å®¹
     * @return åŸ·è¡Œè¿½è¹¤è³‡è¨Š
     */
    @GetMapping("/trace")
    public Map<String, Object> traceExecution(@RequestParam String prompt) {
        try {
            log.info("å·¥å…·éˆåŸ·è¡Œè¿½è¹¤ï¼š{}", prompt);
            
            long startTime = System.currentTimeMillis();
            
            // é€™è£¡å¯ä»¥æ·»åŠ å·¥å…·èª¿ç”¨è¿½è¹¤é‚è¼¯
            String response = toolChainChatClient
                    .prompt(prompt)
                    .call()
                    .content();
            
            long endTime = System.currentTimeMillis();
            
            return Map.of(
                "prompt", prompt,
                "response", response,
                "executionTime", endTime - startTime,
                "toolsUsed", List.of("EnhancedSalesTools", "ProductDetailsTools"), // å¯¦éš›æ‡‰è©²å¾åŸ·è¡Œéç¨‹ä¸­ç²å–
                "timestamp", LocalDateTime.now()
            );
            
        } catch (Exception e) {
            log.error("å·¥å…·éˆåŸ·è¡Œè¿½è¹¤å¤±æ•—", e);
            return Map.of(
                "error", e.getMessage(),
                "timestamp", LocalDateTime.now()
            );
        }
    }
    
    private String buildAnalysisPrompt(ProductAnalysisRequest request) {
        StringBuilder prompt = new StringBuilder();
        
        prompt.append("è«‹é€²è¡Œæ·±åº¦ç”¢å“åˆ†æï¼š\n");
        prompt.append("ç”¢å“ä»£ç¢¼ï¼š").append(request.getProductCode()).append("\n");
        prompt.append("åˆ†æé¡å‹ï¼š").append(request.getAnalysisType()).append("\n");
        
        if (request.getYear() != null) {
            prompt.append("åˆ†æå¹´ä»½ï¼š").append(request.getYear()).append("\n");
        }
        
        prompt.append("\nè«‹æä¾›ï¼š\n");
        
        switch (request.getAnalysisType()) {
            case "comprehensive" -> {
                prompt.append("1. ç”¢å“éŠ·å”®è¡¨ç¾åˆ†æ\n");
                prompt.append("2. æ‰€æœ‰ç”¢å“å‹è™Ÿè©³ç´°è³‡è¨Š\n");
                prompt.append("3. å¸‚å ´ç«¶çˆ­åŠ›è©•ä¼°\n");
                prompt.append("4. æ”¹é€²å»ºè­°å’Œç­–ç•¥\n");
            }
            case "sales" -> {
                prompt.append("1. è©³ç´°éŠ·å”®è³‡æ–™åˆ†æ\n");
                prompt.append("2. éŠ·å”®è¶¨å‹¢å’Œæ¨¡å¼\n");
                prompt.append("3. å¸‚å ´å æœ‰ç‡åˆ†æ\n");
            }
            case "product" -> {
                prompt.append("1. ç”¢å“å‹è™Ÿå®Œæ•´è³‡è¨Š\n");
                prompt.append("2. è¦æ ¼å’Œå®šåƒ¹åˆ†æ\n");
                prompt.append("3. ç”¢å“ç·šå„ªåŒ–å»ºè­°\n");
            }
        }
        
        return prompt.toString();
    }
}
```

### è«‹æ±‚å’Œå›æ‡‰ DTO

```java
package com.example.dto;

import lombok.Data;
import lombok.Builder;
import java.time.LocalDateTime;

@Data
public class ProductAnalysisRequest {
    private String productCode;
    private String analysisType;  // comprehensive, sales, product
    private Integer year;
    private String focusArea;
}

@Data
@Builder
public class ProductAnalysisResponse {
    private boolean success;
    private String productCode;
    private String analysisType;
    private String analysis;
    private Long executionTime;
    private String error;
    private LocalDateTime timestamp;
}
```

---

## 5.8.4 å¯¦éš›å·¥å…·éˆæ‡‰ç”¨å ´æ™¯

### å ´æ™¯ 1ï¼šè¤‡é›œéŠ·å”®åˆ†æ

**ç”¨æˆ¶æŸ¥è©¢**ï¼šã€Œè«‹å‘Šè¨´æˆ‘ 2023 å¹´æœ€ç†±éŠ·çš„ç”¢å“ï¼Œä¸¦åˆ—å‡ºè©²ç”¢å“æ‰€æœ‰å‹è™Ÿçš„è©³ç´°è¦æ ¼å’Œåƒ¹æ ¼ã€

**å·¥å…·éˆåŸ·è¡Œæµç¨‹**ï¼š

```
1. ğŸ” EnhancedSalesTools.getProductSalesRanking(2023)
   â†’ ç²å– 2023 å¹´éŠ·å”®æ’è¡Œ
   â†’ è­˜åˆ¥æœ€ç†±éŠ·ç”¢å“ï¼šPD-1385 æ™ºèƒ½æ‰‹éŒ¶ç³»åˆ—

2. ğŸ“‹ ProductDetailsTools.getProductModels("PD-1385")
   â†’ ç²å– PD-1385 çš„æ‰€æœ‰å‹è™Ÿ
   â†’ è¿”å›ï¼š1385-1, 1385-2, 1385-3, 1385-4

3. ğŸ” ProductDetailsTools.getModelSpecifications("PD-1385", "1385-1")
   â†’ ç²å–å‹è™Ÿ 1385-1 çš„è©³ç´°è¦æ ¼

4. ğŸ” ProductDetailsTools.getModelSpecifications("PD-1385", "1385-2")
   â†’ ç²å–å‹è™Ÿ 1385-2 çš„è©³ç´°è¦æ ¼

5. ğŸ” ProductDetailsTools.getModelSpecifications("PD-1385", "1385-3")
   â†’ ç²å–å‹è™Ÿ 1385-3 çš„è©³ç´°è¦æ ¼

6. ğŸ” ProductDetailsTools.getModelSpecifications("PD-1385", "1385-4")
   â†’ ç²å–å‹è™Ÿ 1385-4 çš„è©³ç´°è¦æ ¼

7. ğŸ§  AI æ•´åˆåˆ†æ
   â†’ ç”Ÿæˆå®Œæ•´çš„åˆ†æå ±å‘Š
```

**AI å›æ‡‰ç¯„ä¾‹**ï¼š

```
ğŸ“Š **2023å¹´æœ€ç†±éŠ·ç”¢å“åˆ†æå ±å‘Š**

ğŸ† **æœ€ä½³éŠ·å”®ç”¢å“**
- ç”¢å“ï¼šPD-1385 æ™ºèƒ½æ‰‹éŒ¶ç³»åˆ—
- éŠ·å”®é‡ï¼š15,000 å°
- ç‡Ÿæ”¶ï¼šNT$ 3.0å„„
- å¸‚å ´å æœ‰ç‡ï¼š35.7%

ğŸ“± **ç”¢å“å‹è™Ÿå®Œæ•´è³‡è¨Š**

**1. æ™ºèƒ½æ‰‹éŒ¶ 1385-1**
- è¦æ ¼ï¼š41mm, GPS, å¿ƒç‡ç›£æ¸¬
- åƒ¹æ ¼ï¼šNT$ 12,900
- å®šä½ï¼šå…¥é–€æ¬¾ï¼Œé©åˆæ—¥å¸¸ä½¿ç”¨

**2. æ™ºèƒ½æ‰‹éŒ¶ 1385-2**
- è¦æ ¼ï¼š45mm, GPS, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬
- åƒ¹æ ¼ï¼šNT$ 15,900
- å®šä½ï¼šé€²éšæ¬¾ï¼Œå¢åŠ å¥åº·ç›£æ¸¬åŠŸèƒ½

**3. æ™ºèƒ½æ‰‹éŒ¶ 1385-3**
- è¦æ ¼ï¼š41mm, GPS+Cellular, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬
- åƒ¹æ ¼ï¼šNT$ 18,900
- å®šä½ï¼šç¨ç«‹é€šè¨Šæ¬¾ï¼Œæ”¯æ´ç¨ç«‹é€šè©±

**4. æ™ºèƒ½æ‰‹éŒ¶ 1385-4**
- è¦æ ¼ï¼š45mm, GPS+Cellular, å¿ƒç‡ç›£æ¸¬, è¡€æ°§æª¢æ¸¬, ECG
- åƒ¹æ ¼ï¼šNT$ 22,900
- å®šä½ï¼šæ——è‰¦æ¬¾ï¼Œå®Œæ•´å¥åº·ç›£æ¸¬åŠŸèƒ½

ğŸ’¡ **å•†æ¥­æ´å¯Ÿ**
- æ™ºèƒ½æ‰‹éŒ¶å¸‚å ´éœ€æ±‚å¼·å‹ï¼Œå å…¬å¸ç¸½éŠ·é‡è¶…é1/3
- ç”¢å“ç·šå®Œæ•´ï¼Œå¾å…¥é–€åˆ°æ——è‰¦éƒ½æœ‰è¦†è“‹
- å¥åº·ç›£æ¸¬åŠŸèƒ½æ˜¯ä¸»è¦è³£é»
- å»ºè­°åŠ å¼·é‹å‹•å’Œå¥åº·ç”Ÿæ…‹ç³»çµ±æ•´åˆ
```

### å ´æ™¯ 2ï¼šç«¶å“æ¯”è¼ƒåˆ†æ

**ç”¨æˆ¶æŸ¥è©¢**ï¼šã€Œæ¯”è¼ƒ PD-1405 å’Œ PD-1234 åœ¨ 2024 å¹´çš„éŠ·å”®è¡¨ç¾ï¼Œä¸¦åˆ†æå„è‡ªçš„ç”¢å“å„ªå‹¢ã€

**å·¥å…·éˆåŸ·è¡Œæµç¨‹**ï¼š

```
1. ğŸ“Š EnhancedSalesTools.compareProductPerformance(2024, ["PD-1405", "PD-1234"])
   â†’ æ¯”è¼ƒå…©å€‹ç”¢å“çš„ 2024 å¹´éŠ·å”®è¡¨ç¾

2. ğŸ“‹ ProductDetailsTools.getProductModels("PD-1405")
   â†’ ç²å– PD-1405 ç”¢å“è©³æƒ…å’Œå‹è™Ÿ

3. ğŸ“‹ ProductDetailsTools.getProductModels("PD-1234")
   â†’ ç²å– PD-1234 ç”¢å“è©³æƒ…å’Œå‹è™Ÿ

4. ğŸ§® CalculatorTools.calculate(...)
   â†’ è¨ˆç®—ç›¸é—œçµ±è¨ˆæ•¸æ“š

5. ğŸ§  AI ç¶œåˆåˆ†æ
   â†’ ç”Ÿæˆç«¶å“æ¯”è¼ƒå ±å‘Š
```

---

## ğŸ“ æœ¬ç« é‡é»å›é¡§

1. **å·¥å…·éˆèª¿ç”¨æŒæ¡**ï¼šå­¸æœƒäº† AI è‡ªå‹•é€²è¡Œå¤šå±¤æ¬¡å·¥å…·èª¿ç”¨çš„æ©Ÿåˆ¶
2. **è¤‡é›œå·¥å…·è¨­è¨ˆ**ï¼šå¯¦ç¾äº†æ”¯æ´éˆå¼èª¿ç”¨çš„é€²éšå·¥å…·ç³»çµ±
3. **æ™ºèƒ½å”èª¿ç³»çµ±**ï¼šå»ºç«‹äº†å·¥å…·é–“çš„æ™ºèƒ½å”èª¿å’Œè³‡æ–™æµè½‰
4. **æ•ˆèƒ½å„ªåŒ–ç­–ç•¥**ï¼šæŒæ¡äº†å·¥å…·éˆçš„æ•ˆèƒ½å„ªåŒ–å’Œæˆæœ¬æ§åˆ¶
5. **ä¼æ¥­ç´šæ‡‰ç”¨**ï¼šå±•ç¤ºäº†çœŸå¯¦çš„ä¼æ¥­å·¥å…·éˆæ‡‰ç”¨å ´æ™¯

### æŠ€è¡“è¦é»ç¸½çµ

| æŠ€è¡“é» | é‡è¦æ€§ | å¯¦ç¾é›£åº¦ | ä½¿ç”¨å ´æ™¯ |
|--------|--------|----------|----------|
| **å·¥å…·éˆèª¿ç”¨** | â­â­â­ | é«˜ | è¤‡é›œæ¥­å‹™æµç¨‹ |
| **æ™ºèƒ½å”èª¿** | â­â­â­ | é«˜ | ä¼æ¥­ç´šæ‡‰ç”¨ |
| **æ•ˆèƒ½å„ªåŒ–** | â­â­ | ä¸­ | ç”Ÿç”¢ç’°å¢ƒ |
| **éŒ¯èª¤è™•ç†** | â­â­ | ä¸­ | ç©©å®šæ€§ä¿è­‰ |
| **ç›£æ§è¿½è¹¤** | â­â­ | é«˜ | é‹ç¶­ç®¡ç† |
| **æˆæœ¬æ§åˆ¶** | â­ | ä¸­ | å•†æ¥­æ‡‰ç”¨ |

### å·¥å…·éˆè¨­è¨ˆåŸå‰‡

**1. å–®ä¸€è·è²¬åŸå‰‡**
- æ¯å€‹å·¥å…·å°ˆæ³¨æ–¼ç‰¹å®šåŠŸèƒ½
- é¿å…å·¥å…·åŠŸèƒ½é‡ç–Š
- ä¿æŒå·¥å…·ä»‹é¢ç°¡æ½”

**2. éˆå¼èª¿ç”¨å„ªåŒ–**
- è¨­è¨ˆåˆç†çš„è³‡æ–™æµè½‰
- é¿å…ä¸å¿…è¦çš„é‡è¤‡èª¿ç”¨
- å¯¦ç¾æ™ºèƒ½çš„å·¥å…·é¸æ“‡

**3. éŒ¯èª¤è™•ç†ç­–ç•¥**
- å„ªé›…çš„é™ç´šæ©Ÿåˆ¶
- å®Œæ•´çš„éŒ¯èª¤æ—¥èªŒ
- ä½¿ç”¨è€…å‹å–„çš„éŒ¯èª¤è¨Šæ¯

### ä¼æ¥­æ‡‰ç”¨åƒ¹å€¼

**1. é™ä½é–‹ç™¼æˆæœ¬**
- ğŸ”§ **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šå·¥å…·å¯é‡è¤‡ä½¿ç”¨å’Œçµ„åˆ
- âš¡ **å¿«é€Ÿé–‹ç™¼**ï¼šæ–°åŠŸèƒ½é€šéå·¥å…·çµ„åˆå¿«é€Ÿå¯¦ç¾
- ğŸ› ï¸ **æ˜“æ–¼ç¶­è­·**ï¼šå–®ä¸€å·¥å…·çš„ä¿®æ”¹ä¸å½±éŸ¿å…¶ä»–åŠŸèƒ½

**2. æå‡ç”¨æˆ¶é«”é©—**
- ğŸ—£ï¸ **è‡ªç„¶äº’å‹•**ï¼šç”¨æˆ¶ç”¨è‡ªç„¶èªè¨€æè¿°è¤‡é›œéœ€æ±‚
- ğŸ¯ **ç²¾æº–å›æ‡‰**ï¼šAI è‡ªå‹•é¸æ“‡æœ€ä½³å·¥å…·çµ„åˆ
- ğŸ“Š **æ·±åº¦åˆ†æ**ï¼šæä¾›æ¯”å‚³çµ± BI æ›´æ·±å…¥çš„æ´å¯Ÿ

**3. æ“´å±•æ¥­å‹™èƒ½åŠ›**
- ğŸš€ **ç„¡é™æ“´å±•**ï¼šæ–°å·¥å…·å¯ç„¡ç¸«æ•´åˆåˆ°ç¾æœ‰ç³»çµ±
- ğŸ”„ **éˆæ´»çµ„åˆ**ï¼šæ ¹æ“šæ¥­å‹™éœ€æ±‚å‹•æ…‹çµ„åˆå·¥å…·
- ğŸ’¡ **å‰µæ–°æ‡‰ç”¨**ï¼šAI å¯ç™¼ç¾äººé¡æœªæƒ³åˆ°çš„å·¥å…·çµ„åˆæ–¹å¼

### ä¸‹ä¸€æ­¥å­¸ç¿’æ–¹å‘

æ­å–œæ‚¨å®Œæˆäº† Function Calling çš„å®Œæ•´å­¸ç¿’ï¼æ¥ä¸‹ä¾†æˆ‘å€‘å°‡é€²å…¥æ›´é€²éšçš„ä¸»é¡Œï¼Œå­¸ç¿’å¦‚ä½•è®“ ChatBot æ“æœ‰è¨˜æ†¶èƒ½åŠ›ï¼Œå»ºç«‹çœŸæ­£æ™ºèƒ½çš„å°è©±ç³»çµ±ã€‚

---

**åƒè€ƒè³‡æ–™ï¼š**
- [Spring AI Advanced Tool Calling](https://docs.spring.io/spring-ai/reference/api/tools.html)
- [AI Agent Design Patterns](https://www.anthropic.com/research/constitutional-ai-harmlessness-from-ai-feedback)
- [Enterprise AI Tool Integration](https://www.mckinsey.com/capabilities/quantumblack/our-insights/the-age-of-ai)
- [Function Calling Best Practices](https://platform.openai.com/docs/guides/function-calling)