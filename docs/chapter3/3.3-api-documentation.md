# 3.3 API æ–‡ä»¶åŒ–èˆ‡æ¸¬è©¦

> **å°æ‡‰ç« ç¯€**: ç¬¬3ç«  - ä¼æ¥­ç´šåŠŸèƒ½
> **å°æ‡‰ç¯„ä¾‹**: `chapter3-enterprise-features`
> **é›£åº¦**: â­â­â˜†â˜†â˜†

---

## ğŸ“š æœ¬ç« æ¦‚è¦

API æ–‡ä»¶æ˜¯å‰å¾Œç«¯å”ä½œçš„æ©‹æ¨‘ï¼Œè‰¯å¥½çš„æ–‡ä»¶å¯ä»¥å¤§å¹…æå‡é–‹ç™¼æ•ˆç‡ã€‚æœ¬ç« å°‡å¸¶ä½ æŒæ¡ Swagger/OpenAPI çš„æ•´åˆèˆ‡ä½¿ç”¨ï¼Œå­¸æœƒè‡ªå‹•ç”Ÿæˆå°ˆæ¥­çš„ API æ–‡ä»¶ã€‚

**å­¸ç¿’ç›®æ¨™**:
- ç†è§£ API æ–‡ä»¶åœ¨åœ˜éšŠå”ä½œä¸­çš„åƒ¹å€¼
- æŒæ¡ SpringDoc OpenAPI çš„é…ç½®èˆ‡æ•´åˆ
- å­¸æœƒä½¿ç”¨ Swagger è¨»è§£è±å¯Œ API æ–‡ä»¶
- ç†Ÿç·´ä½¿ç”¨ Swagger UI æ¸¬è©¦ API
- å»ºç«‹å®Œæ•´çš„ API æ–‡ä»¶åŒ–æµç¨‹

---

## 3.3.1 ç‚ºä»€éº¼éœ€è¦ API æ–‡ä»¶ï¼Ÿ

API æ–‡ä»¶å°±åƒæ˜¯ã€Œä½¿ç”¨æŒ‡å—ã€ï¼Œå°æ–¼é–‹ç™¼åœ˜éšŠå”ä½œå’Œç¬¬ä¸‰æ–¹æ•´åˆè‡³é—œé‡è¦ï¼š

**æ²’æœ‰æ–‡ä»¶çš„ç—›é»**ï¼š
- âŒ API åšä»€éº¼åŠŸèƒ½ä¸æ¸…æ¥š
- âŒ åƒæ•¸æ ¼å¼ä¸æ˜ç¢º
- âŒ å›å‚³è³‡æ–™çµæ§‹æœªçŸ¥
- âŒ éŒ¯èª¤ç¢¼å’Œè™•ç†æ–¹å¼ä¸æ˜

**æœ‰æ–‡ä»¶çš„å„ªå‹¢**ï¼š
- âœ… å‰å¾Œç«¯å”ä½œæ•ˆç‡æå‡
- âœ… æ¸›å°‘æºé€šæˆæœ¬
- âœ… æ–°æˆå“¡å¿«é€Ÿä¸Šæ‰‹
- âœ… æ”¯æ´ç¬¬ä¸‰æ–¹æ•´åˆ

---

## ğŸ” Swagger/OpenAPI å·¥ä½œæµç¨‹

### è‡ªå‹•åŒ–æ–‡ä»¶ç”Ÿæˆæµç¨‹

```mermaid
graph TB
    A[æ·»åŠ  SpringDoc ä¾è³´] --> B[é…ç½® OpenAPI Bean]
    B --> C[åœ¨æ§åˆ¶å™¨æ·»åŠ è¨»è§£]
    C --> D[å•Ÿå‹• Spring Boot æ‡‰ç”¨]
    D --> E[SpringDoc è‡ªå‹•æƒæ]

    E --> F[ç”Ÿæˆ OpenAPI JSON]
    E --> G[ç”Ÿæˆ Swagger UI]

    F --> H["/v3/api-docs"]
    G --> I["/swagger-ui.html"]

    I --> J[äº’å‹•å¼æ¸¬è©¦ä»‹é¢]
    H --> K[API è¦æ ¼æª”æ¡ˆ]

    style A fill:#E3F2FD
    style B fill:#E3F2FD
    style C fill:#FFF3E0
    style D fill:#E8F5E9
    style E fill:#E8F5E9
    style F fill:#C8E6C9
    style G fill:#C8E6C9
    style I fill:#81C784,color:#fff
    style J fill:#66BB6A,color:#fff
```

**æµç¨‹èªªæ˜**ï¼š
1. âœ… æ·»åŠ ä¾è³´å¾Œï¼ŒSpringDoc è‡ªå‹•æ•´åˆåˆ° Spring Boot
2. âœ… é…ç½® OpenAPI Bean å®šç¾© API åŸºæœ¬è³‡è¨Š
3. âœ… ä½¿ç”¨è¨»è§£è±å¯Œ API æ–‡ä»¶å…§å®¹
4. âœ… å•Ÿå‹•æ‡‰ç”¨å¾Œè‡ªå‹•æƒææ‰€æœ‰æ§åˆ¶å™¨
5. âœ… ç”Ÿæˆå…©ç¨®æ ¼å¼ï¼šJSON è¦æ ¼ + äº’å‹•å¼ UI

---

## ğŸ’» æ•´åˆ Swagger/OpenAPI

> âš ï¸ **é‡è¦æé†’**ï¼šSwagger/OpenAPI **ä¸¦é** Spring Boot å…§å»ºåŠŸèƒ½ï¼Œè€Œæ˜¯**ç¬¬ä¸‰æ–¹å¥—ä»¶**ï¼Œéœ€è¦æ‰‹å‹•æ·»åŠ ä¾è³´ã€‚

### SpringDoc vs Springfox å°æ¯”

| æ¯”è¼ƒé …ç›® | SpringDoc | Springfox |
|---------|-----------|-----------|
| **ç¶­è­·ç‹€æ…‹** | âœ… æ´»èºç¶­è­· | âŒ å·²åœæ­¢ç¶­è­· |
| **Spring Boot ç‰ˆæœ¬** | 3.x | 2.x |
| **OpenAPI è¦ç¯„** | OpenAPI 3.0 | OpenAPI 2.0 (Swagger) |
| **æ¨è–¦åº¦** | â­â­â­â­â­ å¼·çƒˆæ¨è–¦ | ä¸æ¨è–¦æ–°å°ˆæ¡ˆä½¿ç”¨ |
| **æœ€æ–°ç‰ˆæœ¬** | 2.2.0+ | 3.0.0 (2020å¹´åœæ›´) |

> ğŸ’¡ **æœ¬æ›¸é¸æ“‡ SpringDoc**ï¼š
> - å”¯ä¸€æ”¯æ´ Spring Boot 3.x çš„æ´»èºå°ˆæ¡ˆ
> - ç¬¦åˆæœ€æ–°çš„ OpenAPI 3.0 è¦ç¯„
> - ç¤¾ç¾¤æ´»èºï¼Œå•é¡Œå›æ‡‰å¿«é€Ÿ
> - èˆ‡ Spring Boot æ•´åˆæ›´ç·Šå¯†

---

### æ­¥é©Ÿ 1: æ·»åŠ ä¾è³´

```xml
<!-- pom.xml -->
<!-- âš ï¸ å¿…é ˆæ˜ç¢ºæŒ‡å®šç‰ˆæœ¬è™Ÿï¼ŒSpringDoc ä¸åœ¨ Spring Boot çš„ä¾è³´ç®¡ç†ä¸­ -->
<dependency>
    <groupId>org.springdoc</groupId>
    <artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
    <version>2.2.0</version>
</dependency>
```

**ç‰ˆæœ¬å°ç…§è¡¨**ï¼š

| Spring Boot ç‰ˆæœ¬ | SpringDoc ç‰ˆæœ¬ | èªªæ˜ |
|------------------|----------------|------|
| **3.0.x - 3.2.x** | **2.2.0+** | âœ… æœ¬æ›¸ä½¿ç”¨ |
| 3.3.x+ | 2.3.0+ | æœ€æ–°ç‰ˆæœ¬ |
| 2.x | 1.7.0 | èˆŠç‰ˆæœ¬ |

> ğŸ“¦ **ç‚ºä»€éº¼å¿…é ˆæŒ‡å®šç‰ˆæœ¬ï¼Ÿ**
> 1. SpringDoc æ˜¯ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼Œä¸åœ¨ Spring Boot BOM ä¸­
> 2. Maven ç„¡æ³•è‡ªå‹•è§£æç‰ˆæœ¬è™Ÿ
> 3. ä¸åŒç‰ˆæœ¬æ”¯æ´ä¸åŒçš„ Spring Boot ç‰ˆæœ¬

---

### æ­¥é©Ÿ 2: é…ç½® OpenAPI

```java
// å°æ‡‰ç¯„ä¾‹: chapter3-enterprise-features/src/main/java/com/example/enterprise/config/OpenApiConfig.java:25

/**
 * OpenAPI (Swagger) é…ç½®
 */
@Configuration
public class OpenApiConfig {

    @Bean
    public OpenAPI customOpenAPI() {
        return new OpenAPI()
                // API åŸºæœ¬è³‡è¨Š
                .info(new Info()
                        .title("ä¼æ¥­ç´šåŠŸèƒ½ API æ–‡ä»¶")
                        .version("1.0.0")
                        .description("å±•ç¤ºè³‡æ–™é©—è­‰ã€æª”æ¡ˆè™•ç†ã€API æ–‡ä»¶åŒ–ç­‰ä¼æ¥­ç´šåŠŸèƒ½")
                        .contact(new Contact()
                                .name("é–‹ç™¼åœ˜éšŠ")
                                .email("dev@example.com")
                                .url("https://example.com"))
                        .license(new License()
                                .name("MIT License")
                                .url("https://opensource.org/licenses/MIT")))
                // ä¼ºæœå™¨åˆ—è¡¨
                .servers(Arrays.asList(
                        new Server().url("http://localhost:8080").description("é–‹ç™¼ç’°å¢ƒ"),
                        new Server().url("https://api.example.com").description("ç”Ÿç”¢ç’°å¢ƒ")
                ));
    }
}
```

**é…ç½®é …ç›®èªªæ˜**ï¼š
- ğŸ”¸ `title`: API æ–‡ä»¶æ¨™é¡Œ
- ğŸ”¸ `version`: API ç‰ˆæœ¬è™Ÿ
- ğŸ”¸ `description`: API è©³ç´°èªªæ˜
- ğŸ”¸ `contact`: è¯çµ¡è³‡è¨Š
- ğŸ”¸ `license`: æˆæ¬Šè³‡è¨Š
- ğŸ”¸ `servers`: ä¼ºæœå™¨ç’°å¢ƒåˆ—è¡¨

---

### æ­¥é©Ÿ 3: è¨ªå• Swagger UI

å•Ÿå‹•æ‡‰ç”¨å¾Œï¼Œè¨ªå•ä»¥ä¸‹ URLï¼š

| åŠŸèƒ½ | URL | èªªæ˜ |
|------|-----|------|
| **Swagger UI** | http://localhost:8080/swagger-ui.html | äº’å‹•å¼æ¸¬è©¦ä»‹é¢ |
| **OpenAPI JSON** | http://localhost:8080/v3/api-docs | API è¦æ ¼æª”æ¡ˆ |
| **OpenAPI YAML** | http://localhost:8080/v3/api-docs.yaml | YAML æ ¼å¼è¦æ ¼ |

**Swagger UI ä»‹é¢é è¦½**ï¼š

```mermaid
graph TB
    API["ä¼æ¥­ç´šåŠŸèƒ½ API æ–‡ä»¶ v1.0.0"]

    subgraph UserAPI["ğŸ“ ä½¿ç”¨è€…ç®¡ç†"]
        U1["ğŸŸ¢ GET /api/users<br/>å–å¾—æ‰€æœ‰ä½¿ç”¨è€…"]
        U2["ğŸŸ¢ GET /api/users/{id}<br/>æ ¹æ“š ID å–å¾—ä½¿ç”¨è€…"]
        U3["ğŸŸ¡ POST /api/users/register<br/>è¨»å†Šæ–°ä½¿ç”¨è€…"]
        U4["ğŸ”´ DELETE /api/users/{id}<br/>åˆªé™¤ä½¿ç”¨è€…"]
    end

    subgraph FileAPI["ğŸ“ æª”æ¡ˆç®¡ç†"]
        F1["ğŸŸ¡ POST /api/files/upload<br/>ä¸Šå‚³æª”æ¡ˆ"]
        F2["ğŸŸ¢ GET /api/files/download/{filename}<br/>ä¸‹è¼‰æª”æ¡ˆ"]
        F3["ğŸŸ¢ GET /api/files/preview/{filename}<br/>é è¦½æª”æ¡ˆ"]
    end

    API --> UserAPI
    API --> FileAPI

    style API fill:#1565C0,stroke:#0D47A1,stroke-width:4px,color:#fff,font-weight:bold
    style UserAPI fill:#90CAF9,stroke:#1565C0,stroke-width:3px,color:#000
    style FileAPI fill:#FFCC80,stroke:#E65100,stroke-width:3px,color:#000
    style U1 fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000
    style U2 fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000
    style U3 fill:#FFF9C4,stroke:#F57F17,stroke-width:2px,color:#000
    style U4 fill:#FFCDD2,stroke:#C62828,stroke-width:2px,color:#000
    style F1 fill:#FFF9C4,stroke:#F57F17,stroke-width:2px,color:#000
    style F2 fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000
    style F3 fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000
```

---

## ğŸ“ ä½¿ç”¨ Swagger è¨»è§£

### æ§åˆ¶å™¨æ–‡ä»¶åŒ–

```java
// å°æ‡‰ç¯„ä¾‹: chapter3-enterprise-features/src/main/java/com/example/enterprise/controller/UserController.java:30

/**
 * ä½¿ç”¨è€…ç®¡ç† API
 * å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Swagger è¨»è§£è±å¯Œ API æ–‡ä»¶
 */
@RestController
@RequestMapping("/api/users")
@RequiredArgsConstructor
@Tag(name = "ä½¿ç”¨è€…ç®¡ç†", description = "ä½¿ç”¨è€…è¨»å†Šã€æŸ¥è©¢èˆ‡åˆªé™¤ API")
public class UserController {

    private final UserService userService;

    /**
     * ç²å–æ‰€æœ‰ä½¿ç”¨è€…
     */
    @GetMapping
    @Operation(summary = "å–å¾—æ‰€æœ‰ä½¿ç”¨è€…", description = "æŸ¥è©¢ç³»çµ±ä¸­æ‰€æœ‰å·²è¨»å†Šçš„ä½¿ç”¨è€…åˆ—è¡¨")
    @ApiResponses(value = {
            @io.swagger.v3.oas.annotations.responses.ApiResponse(
                    responseCode = "200",
                    description = "æŸ¥è©¢æˆåŠŸ",
                    content = @Content(schema = @Schema(implementation = ApiResponse.class))
            )
    })
    public ApiResponse<List<User>> getAllUsers() {
        List<User> users = userService.findAll();
        return ApiResponse.success("æŸ¥è©¢æˆåŠŸï¼Œå…± " + users.size() + " ä½ä½¿ç”¨è€…", users);
    }

    /**
     * æ ¹æ“š ID ç²å–ä½¿ç”¨è€…
     */
    @GetMapping("/{id}")
    @Operation(summary = "æ ¹æ“š ID å–å¾—ä½¿ç”¨è€…", description = "æ ¹æ“šä½¿ç”¨è€… ID æŸ¥è©¢å–®ä¸€ä½¿ç”¨è€…è³‡è¨Š")
    @ApiResponses(value = {
            @io.swagger.v3.oas.annotations.responses.ApiResponse(
                    responseCode = "200",
                    description = "æŸ¥è©¢æˆåŠŸ"
            ),
            @io.swagger.v3.oas.annotations.responses.ApiResponse(
                    responseCode = "404",
                    description = "ä½¿ç”¨è€…ä¸å­˜åœ¨"
            )
    })
    public ApiResponse<User> getUserById(
            @Parameter(description = "ä½¿ç”¨è€… ID", required = true)
            @PathVariable Long id) {
        User user = userService.findById(id);
        return ApiResponse.success("æŸ¥è©¢æˆåŠŸ", user);
    }

    /**
     * ä½¿ç”¨è€…è¨»å†Š
     */
    @PostMapping("/register")
    @ResponseStatus(HttpStatus.CREATED)
    @Operation(summary = "è¨»å†Šæ–°ä½¿ç”¨è€…", description = "è¨»å†Šæ–°ä½¿ç”¨è€…ï¼Œéœ€æä¾›ä½¿ç”¨è€…åç¨±ã€é›»å­éƒµä»¶å’Œå¯†ç¢¼ç­‰è³‡è¨Š")
    @ApiResponses(value = {
            @io.swagger.v3.oas.annotations.responses.ApiResponse(
                    responseCode = "201",
                    description = "è¨»å†ŠæˆåŠŸ"
            ),
            @io.swagger.v3.oas.annotations.responses.ApiResponse(
                    responseCode = "400",
                    description = "è«‹æ±‚è³‡æ–™é©—è­‰å¤±æ•—"
            )
    })
    public ApiResponse<User> registerUser(
            @Parameter(description = "ä½¿ç”¨è€…è¨»å†Šè³‡è¨Š", required = true)
            @Valid @RequestBody UserRegistrationRequest request) {
        User user = userService.registerUser(request);
        return ApiResponse.success("ä½¿ç”¨è€…è¨»å†ŠæˆåŠŸ", user);
    }
}
```

**è¨»è§£èªªæ˜**ï¼š
- ğŸ”¸ `@Tag`: API åˆ†çµ„æ¨™ç±¤
- ğŸ”¸ `@Operation`: API ç«¯é»æè¿°ï¼ˆæ‘˜è¦å’Œè©³ç´°èªªæ˜ï¼‰
- ğŸ”¸ `@ApiResponses`: æ‰€æœ‰å¯èƒ½çš„å›æ‡‰ç‹€æ…‹ç¢¼
- ğŸ”¸ `@Parameter`: åƒæ•¸èªªæ˜
- ğŸ”¸ `@Schema`: è³‡æ–™æ¨¡å‹èªªæ˜

---

### è³‡æ–™æ¨¡å‹æ–‡ä»¶åŒ–

```java
// å°æ‡‰ç¯„ä¾‹: chapter3-enterprise-features/src/main/java/com/example/enterprise/entity/User.java

/**
 * ä½¿ç”¨è€…å¯¦é«”
 */
@Schema(description = "ä½¿ç”¨è€…è³‡è¨Š")
@Entity
@Table(name = "users")
public class User {

    @Schema(description = "ä½¿ç”¨è€… ID", example = "1", accessMode = Schema.AccessMode.READ_ONLY)
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Schema(description = "ä½¿ç”¨è€…åç¨±", example = "å¼µå°æ˜", requiredMode = Schema.RequiredMode.REQUIRED)
    @Column(unique = true, nullable = false)
    private String username;

    @Schema(description = "é›»å­éƒµä»¶åœ°å€", example = "ming@example.com")
    @Column(unique = true, nullable = false)
    private String email;

    @Schema(description = "å»ºç«‹æ™‚é–“", example = "2024-01-15T10:30:00Z", accessMode = Schema.AccessMode.READ_ONLY)
    private LocalDateTime createdAt;

    // Getters and Setters
}
```

**@Schema åƒæ•¸èªªæ˜**ï¼š
- `description`: æ¬„ä½èªªæ˜
- `example`: ç¯„ä¾‹å€¼
- `accessMode`: å­˜å–æ¨¡å¼ï¼ˆREAD_ONLYã€WRITE_ONLYï¼‰
- `requiredMode`: æ˜¯å¦å¿…å¡«

---

### Swagger è¨»è§£é€ŸæŸ¥è¡¨

| è¨»è§£ | é©ç”¨ç¯„åœ | ç”¨é€” | ç¯„ä¾‹ |
|------|---------|------|------|
| **@Tag** | æ§åˆ¶å™¨é¡åˆ¥ | API åˆ†çµ„ | `@Tag(name = "ä½¿ç”¨è€…ç®¡ç†")` |
| **@Operation** | æ§åˆ¶å™¨æ–¹æ³• | API ç«¯é»æè¿° | `@Operation(summary = "ç²å–ä½¿ç”¨è€…")` |
| **@Parameter** | æ–¹æ³•åƒæ•¸ | åƒæ•¸èªªæ˜ | `@Parameter(description = "ä½¿ç”¨è€… ID")` |
| **@Schema** | é¡åˆ¥/æ¬„ä½ | è³‡æ–™æ¨¡å‹èªªæ˜ | `@Schema(description = "ä½¿ç”¨è€…åç¨±")` |
| **@ApiResponse** | æ§åˆ¶å™¨æ–¹æ³• | å›æ‡‰ç‹€æ…‹ç¢¼èªªæ˜ | `@ApiResponse(responseCode = "200")` |
| **@ApiResponses** | æ§åˆ¶å™¨æ–¹æ³• | å¤šå€‹å›æ‡‰ç‹€æ…‹ç¢¼ | `@ApiResponses(value = {...})` |

---

## 3.3.4 API æ¸¬è©¦å·¥å…·

### ä½¿ç”¨ curl æ¸¬è©¦

```bash
# GET è«‹æ±‚
curl -X GET "http://localhost:8080/api/users?page=0&size=10"

# POST è«‹æ±‚ï¼ˆJSONï¼‰
curl -X POST "http://localhost:8080/api/users" \
     -H "Content-Type: application/json" \
     -d '{"name": "æ¸¬è©¦ä½¿ç”¨è€…", "email": "test@example.com"}'

# æª”æ¡ˆä¸Šå‚³
curl -X POST "http://localhost:8080/api/files/upload" -F "file=@test.jpg"
```

### ä½¿ç”¨ Postman æˆ– Swagger UI æ¸¬è©¦

**æ¨è–¦æ–¹å¼**ï¼š
- âœ… **Swagger UI**ï¼šå…§å»ºæ¸¬è©¦ä»‹é¢ï¼ˆhttp://localhost:8080/swagger-ui.htmlï¼‰
- âœ… **Postman**ï¼šåŠŸèƒ½å®Œæ•´çš„ API æ¸¬è©¦å·¥å…·
- âœ… **curl**ï¼šå‘½ä»¤åˆ—å¿«é€Ÿæ¸¬è©¦

> ğŸ’¡ **æç¤º**ï¼šSwagger UI æä¾›å³æ™‚æ¸¬è©¦åŠŸèƒ½ï¼Œå¯ç›´æ¥åœ¨æ–‡ä»¶é é¢æ¸¬è©¦ API

---

## 3.3.5 API æ¸¬è©¦é¡å‹

| æ¸¬è©¦é¡å‹ | ç›®çš„ | æ¸¬è©¦ç¯„åœ | é©ç”¨å ´æ™¯ |
|----------|------|----------|----------|
| **åŠŸèƒ½æ¸¬è©¦** | é©—è­‰ API åŠŸèƒ½æ­£ç¢ºæ€§ | å–®ä¸€ API ç«¯é» | åŸºæœ¬ CRUD æ“ä½œ |
| **æ•´åˆæ¸¬è©¦** | é©—è­‰ç³»çµ±é–“å”ä½œ | å¤šå€‹ API ç«¯é» | æ¥­å‹™æµç¨‹æ¸¬è©¦ |
| **æ•ˆèƒ½æ¸¬è©¦** | é©—è­‰å›æ‡‰æ™‚é–“å’Œååé‡ | ç³»çµ±è² è¼‰èƒ½åŠ› | é«˜ä½µç™¼å ´æ™¯ |
| **å®‰å…¨æ¸¬è©¦** | é©—è­‰å®‰å…¨æ©Ÿåˆ¶ | èªè­‰æˆæ¬Šæ©Ÿåˆ¶ | æ•æ„Ÿè³‡æ–™ä¿è­· |

---

## ğŸ¬ å¯¦éš›æ‡‰ç”¨å ´æ™¯

### å ´æ™¯ 1: ä½¿ç”¨ Swagger UI æ¸¬è©¦ API

```
1. å•Ÿå‹•æ‡‰ç”¨
   mvn spring-boot:run

2. æ‰“é–‹ Swagger UI
   http://localhost:8080/swagger-ui.html

3. æ¸¬è©¦ä½¿ç”¨è€…è¨»å†Š
   å±•é–‹ "ä½¿ç”¨è€…ç®¡ç†" â†’ "POST /api/users/register"
   é»æ“Š "Try it out"
   å¡«å¯«è«‹æ±‚é«”ï¼š
   {
     "username": "kevin123",
     "email": "kevin@example.com",
     "password": "SecurePass123!",
     "fullName": "Kevin Tsai",
     "age": 25
   }
   é»æ“Š "Execute"

4. æŸ¥çœ‹å›æ‡‰
   Status: 201 Created
   Response body:
   {
     "code": 201,
     "message": "ä½¿ç”¨è€…è¨»å†ŠæˆåŠŸ",
     "data": {
       "id": 1,
       "username": "kevin123",
       ...
     }
   }
```

---

### å ´æ™¯ 2: å‰ç«¯é–‹ç™¼è€…ä½¿ç”¨ API æ–‡ä»¶

```javascript
// å‰ç«¯é–‹ç™¼è€…æŸ¥çœ‹ Swagger UI å¾Œï¼ŒçŸ¥é“å¦‚ä½•å‘¼å« API

// 1. æŸ¥çœ‹ API ç«¯é»ï¼šPOST /api/users/register
// 2. æŸ¥çœ‹è«‹æ±‚æ ¼å¼ï¼šéœ€è¦ usernameã€emailã€password ç­‰æ¬„ä½
// 3. æŸ¥çœ‹å›æ‡‰æ ¼å¼ï¼š201 æˆåŠŸï¼Œ400 é©—è­‰å¤±æ•—

// æ ¹æ“šæ–‡ä»¶æ’°å¯«ç¨‹å¼ç¢¼
async function registerUser(userData) {
  const response = await fetch('http://localhost:8080/api/users/register', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(userData)
  });

  if (response.status === 201) {
    const result = await response.json();
    console.log('è¨»å†ŠæˆåŠŸ', result.data);
  } else if (response.status === 400) {
    const error = await response.json();
    console.error('é©—è­‰å¤±æ•—', error.errors);
  }
}
```

---

## ğŸ“ é‡é»å›é¡§

### æ ¸å¿ƒæ¦‚å¿µ

âœ… **API æ–‡ä»¶çš„åƒ¹å€¼**ï¼šå‰å¾Œç«¯å”ä½œã€ç¬¬ä¸‰æ–¹æ•´åˆã€æ–°äººä¸Šæ‰‹çš„é‡è¦å·¥å…·
âœ… **SpringDoc OpenAPI**ï¼šSpring Boot 3.x çš„æ¨™æº–æ–‡ä»¶åŒ–è§£æ±ºæ–¹æ¡ˆ
âœ… **è‡ªå‹•åŒ–ç”Ÿæˆ**ï¼šé€éè¨»è§£è‡ªå‹•ç”Ÿæˆå®Œæ•´çš„ API æ–‡ä»¶
âœ… **äº’å‹•å¼æ¸¬è©¦**ï¼šSwagger UI æä¾›å³æ™‚æ¸¬è©¦åŠŸèƒ½
âœ… **æ¨™æº–åŒ–è¦æ ¼**ï¼šç¬¦åˆ OpenAPI 3.0 æ¨™æº–

### SpringDoc æ•´åˆæ­¥é©Ÿ

```mermaid
graph LR
    A[1. æ·»åŠ ä¾è³´] --> B[2. é…ç½® OpenAPI]
    B --> C[3. æ·»åŠ è¨»è§£]
    C --> D[4. å•Ÿå‹•æ‡‰ç”¨]
    D --> E[5. è¨ªå• Swagger UI]

    style A fill:#1565C0,stroke:#0D47A1,stroke-width:4px,color:#fff,font-weight:bold
    style B fill:#1976D2,stroke:#0D47A1,stroke-width:4px,color:#fff,font-weight:bold
    style C fill:#F57C00,stroke:#E65100,stroke-width:4px,color:#fff,font-weight:bold
    style D fill:#388E3C,stroke:#1B5E20,stroke-width:4px,color:#fff,font-weight:bold
    style E fill:#2E7D32,stroke:#1B5E20,stroke-width:4px,color:#fff,font-weight:bold
```

### Swagger è¨»è§£å®Œæ•´æ¸…å–®

| è¨»è§£ | é©ç”¨ç¯„åœ | ç”¨é€” | å¿…å¡« |
|------|---------|------|------|
| `@Tag` | é¡åˆ¥ | API åˆ†çµ„ | å»ºè­° |
| `@Operation` | æ–¹æ³• | API ç«¯é»æè¿° | å»ºè­° |
| `@Parameter` | åƒæ•¸ | åƒæ•¸èªªæ˜ | å¯é¸ |
| `@Schema` | é¡åˆ¥/æ¬„ä½ | è³‡æ–™æ¨¡å‹èªªæ˜ | å¯é¸ |
| `@ApiResponse` | æ–¹æ³• | å–®ä¸€å›æ‡‰èªªæ˜ | å¯é¸ |
| `@ApiResponses` | æ–¹æ³• | å¤šå€‹å›æ‡‰èªªæ˜ | å»ºè­° |

### æœ€ä½³å¯¦è¸

| å¯¦è¸é …ç›® | èªªæ˜ | ç¯„ä¾‹ |
|---------|------|------|
| **å®Œæ•´çš„æè¿°** | æ¯å€‹ API éƒ½è¦æœ‰æ¸…æ™°çš„èªªæ˜ | `@Operation(summary = "...")` |
| **ç¯„ä¾‹å€¼** | æä¾›å¯¦éš›å¯ç”¨çš„ç¯„ä¾‹ | `@Schema(example = "kevin@example.com")` |
| **éŒ¯èª¤ç¢¼èªªæ˜** | åˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„éŒ¯èª¤ç¢¼ | `@ApiResponses` |
| **åˆ†çµ„ç®¡ç†** | ä½¿ç”¨ Tag åˆ†çµ„ API | `@Tag(name = "ä½¿ç”¨è€…ç®¡ç†")` |
| **ç‰ˆæœ¬æ§åˆ¶** | API æ–‡ä»¶åŒ…å«ç‰ˆæœ¬è™Ÿ | `version = "1.0.0"` |

---

## ğŸš€ ä¸‹ä¸€æ­¥

æ­å–œï¼ä½ å·²ç¶“å®Œæˆç¬¬3ç« çš„å­¸ç¿’ï¼ŒæŒæ¡äº†ä¼æ¥­ç´šåŠŸèƒ½é–‹ç™¼çš„æ ¸å¿ƒæŠ€èƒ½ï¼š

âœ… è³‡æ–™é©—è­‰èˆ‡éŒ¯èª¤è™•ç†
âœ… æª”æ¡ˆä¸Šå‚³èˆ‡ä¸‹è¼‰
âœ… API æ–‡ä»¶åŒ–èˆ‡æ¸¬è©¦

**æ¥ä¸‹ä¾†**ï¼Œæˆ‘å€‘å°‡é€²å…¥ Spring AI çš„ä¸–ç•Œï¼š

ğŸ‘‰ [ç¬¬4ç« ï¼šSpring AI å…¥é–€](../chapter4/README.md) - é–‹å§‹ä½ çš„ AI æ‡‰ç”¨é–‹ç™¼ä¹‹æ—…

---

## ğŸ“š å®Œæ•´ç¯„ä¾‹

æœ¬ç« æ¦‚å¿µçš„å®Œæ•´å¯¦ç¾è«‹åƒè€ƒï¼š

ğŸ“ **chapter3-enterprise-features**
- `src/main/java/com/example/enterprise/config/OpenApiConfig.java` - Swagger é…ç½®
- `src/main/java/com/example/enterprise/controller/UserController.java` - å®Œæ•´çš„è¨»è§£ç¯„ä¾‹
- `src/main/java/com/example/enterprise/controller/FileStorageController.java` - æª”æ¡ˆ API æ–‡ä»¶åŒ–
- `pom.xml` - SpringDoc ä¾è³´é…ç½®

ğŸ”— **å•Ÿå‹•ç¯„ä¾‹**:
```bash
cd code-examples/chapter3-enterprise-features
mvn spring-boot:run
```

ğŸ§ª **è¨ªå• Swagger UI**:
```bash
# Swagger UI äº’å‹•å¼æ–‡ä»¶
http://localhost:8080/swagger-ui.html

# OpenAPI JSON è¦æ ¼
http://localhost:8080/v3/api-docs

# OpenAPI YAML è¦æ ¼
http://localhost:8080/v3/api-docs.yaml
```

---

## ğŸ”— åƒè€ƒè³‡æº

- **SpringDoc OpenAPI å®˜æ–¹**ï¼š[springdoc.org](https://springdoc.org/)
- **OpenAPI è¦ç¯„**: [OpenAPI Specification](https://swagger.io/specification/)
- **Swagger UI æ–‡ä»¶**: [Swagger UI](https://swagger.io/tools/swagger-ui/)
- **Spring Boot æ•´åˆæŒ‡å—**: [SpringDoc Guide](https://springdoc.org/#getting-started)

---

**ç›¸é—œç« ç¯€**:
- â† ä¸Šä¸€ç¯€: [3.2 æª”æ¡ˆä¸Šå‚³èˆ‡ä¸‹è¼‰](./3.2-file-upload-download.md)
- â†’ ä¸‹ä¸€ç« : [ç¬¬4ç«  Spring AI å…¥é–€](../chapter4/README.md)
- ğŸ“– å›åˆ°ç›®éŒ„: [ç¬¬3ç«  README](./README.md)
