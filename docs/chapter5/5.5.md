# 5.5 聲優太花錢？找 AI 幫你配音

> **本章重點**：學習使用 Spring AI 的文字轉語音功能，建立完整的 AI 配音系統，掌握語音合成和音訊處理技術，為多媒體內容創作提供專業的語音解決方案。

## 🎯 學習目標

完成本章學習後，您將能夠：

- 🎯 **理解文字轉語音技術**：掌握 TTS 技術的工作原理和應用場景
- 🎯 **實現多種語音風格**：支援不同聲音、語速、語調的語音生成
- 🎯 **建立配音管理系統**：完整的語音生成、儲存和下載功能
- 🎯 **優化語音品質**：掌握語音參數調整和品質控制技巧
- 🎯 **企業級應用設計**：建立可商用的 AI 配音服務平台

---

## 5.5.1 AI 配音技術革命

### AI 有 ABC 腔調

![AI 配音](https://ithelp.ithome.com.tw/upload/images/20240810/20161290YGtkKt0BkG.jpg)

昨天教大家上字幕，今天則是反過來，給文字讓 AI 幫你配音！

比起以前文字轉聲音的軟體，AI 的聲音更為自然，角色跟速度也都能調整，讓我們看看如何操作吧。

### AI 配音 vs 傳統配音對比

| 比較項目 | AI 配音 | 傳統配音 | 優勢分析 |
|----------|---------|----------|----------|
| **成本** | $0.015/1K字元 | $50-200/分鐘 | AI 節省 95%+ 成本 |
| **速度** | 即時生成 | 數天製作 | AI 快 100+ 倍 |
| **一致性** | 完全一致 | 人為變化 | AI 品質穩定 |
| **可調性** | 隨時調整 | 重新錄製 | AI 彈性極高 |
| **語言支援** | 多語言 | 限制較多 | AI 支援更廣 |
| **情感表達** | 持續改善 | 自然豐富 | 傳統仍有優勢 |

### AI 配音的核心價值

**1. 成本效益顯著**
- 💰 **大幅降低成本**：相比專業配音員節省 95% 以上費用
- ⏰ **即時生成**：從文字到語音幾秒鐘完成
- 🔄 **無限修改**：隨時調整內容無額外成本
- 📈 **規模化生產**：批次處理大量內容

**2. 品質持續提升**
- 🎭 **多種聲音選擇**：男聲、女聲、不同年齡和風格
- 🎵 **語調控制**：調整語速、音調、情感表達
- 🌍 **多語言支援**：支援數十種語言和方言
- 🔊 **高品質音訊**：CD 級音質輸出

**3. 應用場景廣泛**
- 📚 **教育培訓**：課程講解、有聲書製作
- 🎬 **影片製作**：旁白配音、角色對話
- 📢 **廣告行銷**：廣告配音、產品介紹
- 🤖 **智能助手**：語音回應、客服系統
- 🎮 **遊戲開發**：角色配音、劇情對話

---

## 5.5.2 Spring AI 語音生成服務

### 主要支援的語音服務

| 服務商 | 模型 | 語音選項 | 品質 | 成本 | 推薦場景 |
|--------|------|----------|------|------|----------|
| **OpenAI** | TTS-1, TTS-1-HD | 6種聲音 | 極高 | 中 | 通用配音、專業製作 |
| **Azure OpenAI** | TTS-1, TTS-1-HD | 6種聲音 | 極高 | 中 | 企業級應用 |
| **ElevenLabs** | 多種模型 | 自訂聲音 | 極高 | 高 | 高端配音、聲音克隆 |
| **Google Cloud** | WaveNet | 多種聲音 | 高 | 低 | 大量生成、成本敏感 |

### OpenAI TTS 語音選項詳解

文字轉語音也是劃分在 **Audio Model** 的部分，Spring AI 目前主要支援 OpenAI 和 Azure OpenAI：

![Spring AI 語音支援](https://ithelp.ithome.com.tw/upload/images/20240809/20161290wi54q7gekg.png)

**OpenAI TTS 可用聲音**：

| 聲音名稱 | 特色 | 適用場景 | 語言支援 |
|----------|------|----------|----------|
| **alloy** | 中性、清晰 | 新聞播報、教學 | 多語言 |
| **echo** | 男性、沉穩 | 商業簡報、紀錄片 | 多語言 |
| **fable** | 女性、溫暖 | 故事講述、客服 | 多語言 |
| **onyx** | 男性、深沉 | 廣告配音、旁白 | 多語言 |
| **nova** | 女性、活潑 | 廣告、娛樂內容 | 多語言 |
| **shimmer** | 女性、柔和 | 冥想、放鬆內容 | 多語言 |

**模型差異**：
- **TTS-1**：標準品質，速度快，成本低
- **TTS-1-HD**：高品質，音質更佳，成本稍高

---

## 5.5.3 專案建立與配置

```yaml
# application.yml
spring:
  application:
    name: spring-ai-voice-generation

  # 排除 Redis 自動配置（系統無 Redis 服務器時使用）
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
      - org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration

  # OpenAI 配置
  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
      base-url: https://api.openai.com
      audio:
        speech:
          options:
            model: tts-1-hd
            voice: alloy
            response-format: mp3
            speed: 1.0

# 應用程式配置
app:
  voice:
    generation:
      max-batch-size: 10
      default-timeout: 30s
      cache-enabled: true
      output-directory: ./generated-voices
      supported-formats: ["mp3", "opus", "aac", "flac"]
      max-text-length: 4096
      default-voice: alloy
      default-model: tts-1-hd
```
---

## 5.5.4 基礎語音生成功能

### 語音生成控制器

```java
### 語音生成服務

```java

@Service
@RequiredArgsConstructor
@Slf4j
public class VoiceGenerationService {
    
    private final SpeechModel speechModel;
    private final VoiceStorageService storageService;
    
    /**
     * 基礎語音生成
     * @param text 文字內容
     * @param voice 聲音選擇
     * @param speed 語速
     * @return 音訊資料
     */
    public byte[] generateVoice(String text, String voice, Float speed) {
        try {
            // 建立語音選項
            OpenAiAudioSpeechOptions options = OpenAiAudioSpeechOptions.builder()
                    .model("tts-1-hd")
                    .voice(OpenAiAudioApi.SpeechRequest.Voice.valueOf(voice.toUpperCase()))
                    .responseFormat(OpenAiAudioApi.SpeechRequest.AudioResponseFormat.MP3)
                    .speed(speed)
                    .build();
            
            // 建立語音請求
            SpeechPrompt speechPrompt = new SpeechPrompt(text, options);
            
            // 執行語音生成
            SpeechResponse response = speechModel.call(speechPrompt);
            
            return response.getResult().getOutput();
            
        } catch (Exception e) {
            log.error("語音生成失敗：{}", text, e);
            throw new RuntimeException("語音生成失敗：" + e.getMessage(), e);
        }
    }
    
    /**
     * 進階語音生成
     * @param request 語音生成請求
     * @return 語音回應
     */
    public VoiceResponse generateAdvancedVoice(VoiceRequest request) {
        try {
            // 建立進階語音選項
            OpenAiAudioSpeechOptions options = OpenAiAudioSpeechOptions.builder()
                    .model(request.getModel())
                    .voice(OpenAiAudioApi.SpeechRequest.Voice.valueOf(
                            request.getVoice().toUpperCase()))
                    .responseFormat(OpenAiAudioApi.SpeechRequest.AudioResponseFormat
                            .valueOf(request.getFormat().toUpperCase()))
                    .speed(request.getSpeed())
                    .build();
            
            SpeechPrompt speechPrompt = new SpeechPrompt(request.getText(), options);
            SpeechResponse response = speechModel.call(speechPrompt);
            
            byte[] audioData = response.getResult().getOutput();
            
            // 儲存音訊檔案（如果需要）
            String filePath = null;
            if (request.isSaveFile()) {
                filePath = storageService.saveAudioFile(
                        audioData, 
                        request.getText(), 
                        request.getVoice(), 
                        request.getFormat()
                );
            }
            
            return VoiceResponse.builder()
                    .success(true)
                    .text(request.getText())
                    .voice(request.getVoice())
                    .model(request.getModel())
                    .format(request.getFormat())
                    .speed(request.getSpeed())
                    .audioData(audioData)
                    .filePath(filePath)
                    .fileSize((long) audioData.length)
                    .duration(estimateAudioDuration(request.getText(), request.getSpeed()))
                    .timestamp(LocalDateTime.now())
                    .build();
            
        } catch (Exception e) {
            log.error("進階語音生成失敗：{}", request.getText(), e);
            throw new RuntimeException("進階語音生成失敗：" + e.getMessage(), e);
        }
    }
}
```

---

## 📝 本章重點回顧
1. **文字轉語音技術**：掌握了 TTS 技術的工作原理和 AI 配音優勢
2. **多聲音支援**：實現了不同風格的 AI 聲音選擇

### 成本效益分析

**OpenAI TTS 定價**：
- 💰 **成本**：$0.015 per 1K characters
- ⏱️ **速度**：即時生成，無等待時間
- 🎯 **品質**：接近人聲的自然度
- 📊 **性價比**：相比專業配音節省 95%+ 成本

### 最佳實踐建議

1. **文字預處理**：優化數字、縮寫和標點符號
2. **聲音選擇**：根據內容類型選擇合適的聲音
3. **語速調整**：根據聽眾和場景調整語速
4. **批次處理**：大量內容使用非同步處理提升效率
5. **品質控制**：實施文字品質評估和語音後處理

### 下一步學習方向

在下一章中，我們將學習 Function Calling 技術，探索如何讓 AI 調用外部工具和服務，實現更強大的功能整合。

---

**參考資料：**
- [Spring AI Audio Speech Documentation](https://docs.spring.io/spring-ai/reference/api/audio.html)
- [OpenAI Text-to-Speech API](https://platform.openai.com/docs/guides/text-to-speech)
- [Audio Format Specifications](https://en.wikipedia.org/wiki/Audio_file_format)
- [Speech Synthesis Markup Language (SSML)](https://www.w3.org/TR/speech-synthesis/)