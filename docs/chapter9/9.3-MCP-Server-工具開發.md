# 9.3 MCP Server å·¥å…·é–‹ç™¼

> **å°æ‡‰ç« ç¯€**: å¯¦æˆ°é–‹ç™¼
> **é›£åº¦**: â­â­â­â˜†â˜†
> **å­¸ç¿’æ™‚é–“**: 75 åˆ†é˜

---

## ğŸ“š æœ¬ç« æ¦‚è¦

æŒæ¡å¦‚ä½•ä½¿ç”¨ Spring AI é–‹ç™¼ MCP Serverï¼Œæä¾›æ¨™æº–åŒ–çš„å·¥å…·æœå‹™çµ¦ AI æ¨¡å‹èª¿ç”¨ã€‚æœ¬ç« å°‡å¾ Maven é…ç½®é–‹å§‹ï¼Œå­¸ç¿’å¦‚ä½•ä½¿ç”¨ `@Tool` è¨»è§£å®šç¾©å·¥å…·ï¼Œä¸¦é€é `ToolCallbackProvider` è¨»å†Šå·¥å…·ï¼Œæ”¯æ´ STDIO å’Œ SSE é›™å‚³è¼¸æ¨¡å¼ã€‚

**å­¸ç¿’ç›®æ¨™**:
- é…ç½® Spring AI MCP Server å°ˆæ¡ˆ
- ä½¿ç”¨ @Tool è¨»è§£é–‹ç™¼å·¥å…·
- è¨»å†Šå’Œç®¡ç† ToolCallbackProvider
- æ”¯æ´ STDIO å’Œ SSE é›™å‚³è¼¸æ¨¡å¼
- æ•´åˆå¤–éƒ¨ API æœå‹™

**å°æ‡‰ç¯„ä¾‹å°ˆæ¡ˆ**: `code-examples/chapter9-mcp-integration/chapter9-mcp-server-tools-resources`

---

## ğŸ¯ MCP Server æ¶æ§‹æ¦‚è¦½

```mermaid
graph TB
    subgraph MCP_Server["MCP Server"]
        APP[McpServerApplication ä¸»ç¨‹å¼] --> PROVIDER[ToolCallbackProvider å·¥å…·è¨»å†Šå™¨]
        PROVIDER --> WEATHER_TOOL[WeatherToolProvider @Toolæ¨™è¨»]
        PROVIDER --> MATH_TOOL[MathToolProvider @Toolæ¨™è¨»]
        PROVIDER --> TEXT_TOOL[TextToolProvider @Toolæ¨™è¨»]
        PROVIDER --> TIME_TOOL[TimeToolProvider @Toolæ¨™è¨»]
        WEATHER_TOOL --> API[å¤–éƒ¨API Open-Meteo]
    end

    subgraph Transport["å‚³è¼¸å±¤"]
        STDIO_TRANSPORT[STDIO æ¨™æº–è¼¸å…¥è¼¸å‡º]
        SSE_TRANSPORT[SSE HTTPç«¯é»]
    end

    CLIENT[MCP Client] --> STDIO_TRANSPORT
    REMOTE[Remote Client] --> SSE_TRANSPORT
    APP --> STDIO_TRANSPORT
    APP --> SSE_TRANSPORT

    style APP fill:#e1f5ff
    style PROVIDER fill:#fff4e6
    style WEATHER_TOOL fill:#e8f5e9
    style MATH_TOOL fill:#e8f5e9
    style TEXT_TOOL fill:#e8f5e9
    style TIME_TOOL fill:#e8f5e9
```

---

## ğŸ”§ å°ˆæ¡ˆé…ç½®

### Maven ä¾è³´

MCP Server é–‹ç™¼éœ€è¦ä»¥ä¸‹æ ¸å¿ƒä¾è³´ï¼š

```xml
<!-- Spring AI MCP Server WebMVC -->
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-server-webmvc</artifactId>
</dependency>

<!-- WebFlux (ç”¨æ–¼èª¿ç”¨å¤–éƒ¨ API) -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-webflux</artifactId>
</dependency>
```

**å°æ‡‰æª”æ¡ˆ**: `chapter9-mcp-server-tools-resources/pom.xml:38-48`

**ç‰ˆæœ¬ç®¡ç†**:
- Spring Boot: 3.5.7
- Spring AI: 1.0.3
- Java: 21

---

### application.yml é…ç½®

```yaml
spring:
  ai:
    mcp:
      server:
        # Server åŸºæœ¬è³‡è¨Š
        name: tools-resources-server
        version: 1.0.0

        # Server é¡å‹ï¼ˆåŒæ­¥ï¼‰
        type: SYNC

        # STDIO æ¨¡å¼é–‹é—œï¼ˆfalse=SSE, true=STDIOï¼‰
        stdio: false

        # SSE ç«¯é»é…ç½®ï¼ˆç•¶ stdio=false æ™‚ä½¿ç”¨ï¼‰
        sse-message-endpoint: /mcp/message

        # è®Šæ›´é€šçŸ¥åŠŸèƒ½
        tool-change-notification: true

server:
  port: 8080  # SSE æ¨¡å¼çš„ HTTP åŸ è™Ÿ
```

**å°æ‡‰æª”æ¡ˆ**: `chapter9-mcp-server-tools-resources/src/main/resources/application.yml:1-27`

**é…ç½®èªªæ˜**:

| é…ç½®é … | èªªæ˜ | å€¼ |
|--------|------|-----|
| `name` | Server åç¨± | è‡ªå®šç¾©ï¼Œå»ºè­°èªç¾©åŒ– |
| `type` | è™•ç†æ¨¡å¼ | SYNCï¼ˆåŒæ­¥ï¼‰/ ASYNCï¼ˆç•°æ­¥ï¼‰ |
| `stdio` | å‚³è¼¸æ¨¡å¼ | true=STDIO, false=SSE |
| `sse-message-endpoint` | SSE ç«¯é»è·¯å¾‘ | é è¨­ `/mcp/message` |
| `tool-change-notification` | å·¥å…·è®Šæ›´é€šçŸ¥ | true=å•Ÿç”¨å‹•æ…‹æ›´æ–° |

---

## ğŸ› ï¸ é–‹ç™¼ MCP å·¥å…·

### ä½¿ç”¨ @Tool è¨»è§£

Spring AI æä¾›äº† `@Tool` è¨»è§£ä¾†å®šç¾© MCP å·¥å…·ï¼Œé€™æ˜¯å®˜æ–¹æ¨è–¦çš„æ–¹å¼ã€‚

#### åŸºç¤å·¥å…·ç¯„ä¾‹ï¼šæ•¸å­¸é‹ç®—

```java
@Service
@Slf4j
public class MathToolProvider {

    @Tool(description = "Calculate the sum of multiple numbers")
    public double sum(double... numbers) {
        log.info("åŸ·è¡ŒåŠ æ³•é‹ç®—: {}", Arrays.toString(numbers));

        if (numbers == null || numbers.length == 0) {
            return 0.0;
        }

        double result = Arrays.stream(numbers).sum();
        log.info("åŠ æ³•çµæœ: {} = {}", Arrays.toString(numbers), result);

        return result;
    }

    @Tool(description = "Divide two numbers (dividend / divisor)")
    public double divide(double dividend, double divisor) {
        log.info("åŸ·è¡Œé™¤æ³•é‹ç®—: {} Ã· {}", dividend, divisor);

        if (divisor == 0) {
            throw new ArithmeticException("é™¤æ•¸ä¸èƒ½ç‚ºé›¶");
        }

        return dividend / divisor;
    }
}
```

**å°æ‡‰æª”æ¡ˆ**: `chapter9-mcp-server-tools-resources/src/main/java/com/example/mcp/server/provider/tool/MathToolProvider.java:23-81`

**é—œéµè¦é»**:
- ä½¿ç”¨ `@Service` å°‡é¡åˆ¥è¨»å†Šç‚º Spring Bean
- ä½¿ç”¨ `@Tool(description = "...")` æ¨™è¨»å¯èª¿ç”¨çš„æ–¹æ³•
- description æœƒé¡¯ç¤ºçµ¦ AI æ¨¡å‹ï¼Œå¹«åŠ©å…¶ç†è§£å·¥å…·ç”¨é€”
- æ–¹æ³•åƒæ•¸æœƒè‡ªå‹•è½‰æ›ç‚ºå·¥å…·åƒæ•¸
- æ”¯æ´åŸºæœ¬é¡å‹ã€é™£åˆ—ã€å¯è®Šåƒæ•¸

---

#### é€²éšå·¥å…·ç¯„ä¾‹ï¼šå¤–éƒ¨ API æ•´åˆ

```java
@Service
@Slf4j
public class WeatherToolProvider {

    private final WebClient webClient;

    public WeatherToolProvider() {
        this.webClient = WebClient.create();
    }

    @Tool(description = "Get weather temperature for a specific location using latitude and longitude coordinates")
    public WeatherResponse getTemperature(double latitude, double longitude, String city) {

        log.info("æŸ¥è©¢å¤©æ°£ - åŸå¸‚: {}, ç·¯åº¦: {}, ç¶“åº¦: {}", city, latitude, longitude);

        try {
            // èª¿ç”¨ Open-Meteo API
            WeatherResponse response = webClient
                .get()
                .uri("https://api.open-meteo.com/v1/forecast?latitude={latitude}&longitude={longitude}&current=temperature_2m",
                        latitude, longitude)
                .retrieve()
                .bodyToMono(WeatherResponse.class)
                .block();

            if (response != null && response.getCurrent() != null) {
                log.info("å¤©æ°£æŸ¥è©¢æˆåŠŸ - åŸå¸‚: {}, æº«åº¦: {}Â°C",
                        city, response.getCurrent().getTemperature());
            }

            return response;

        } catch (Exception e) {
            log.error("æŸ¥è©¢å¤©æ°£å¤±æ•— - åŸå¸‚: {}, éŒ¯èª¤: {}", city, e.getMessage());
            throw new RuntimeException("ç„¡æ³•ç²å–å¤©æ°£è³‡è¨Š: " + e.getMessage(), e);
        }
    }
}
```

**å°æ‡‰æª”æ¡ˆ**: `chapter9-mcp-server-tools-resources/src/main/java/com/example/mcp/server/provider/tool/WeatherToolProvider.java:37-63`

**æŠ€è¡“äº®é»**:
- ä½¿ç”¨ `WebClient` èª¿ç”¨å¤–éƒ¨ REST API
- æ•´åˆ Open-Meteo å…è²»å¤©æ°£æœå‹™
- å®Œæ•´çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„
- æ”¯æ´è‡ªå®šç¾©å›æ‡‰æ¨¡å‹ï¼ˆWeatherResponseï¼‰

---

## ğŸ“¦ è¨»å†Š ToolCallbackProvider

å®šç¾©å¥½å·¥å…·å¾Œï¼Œéœ€è¦åœ¨ä¸»ç¨‹å¼ä¸­è¨»å†Š `ToolCallbackProvider`ï¼ŒSpring AI æœƒè‡ªå‹•æƒæä¸¦æš´éœ²é€™äº›å·¥å…·ã€‚

### ä¸»ç¨‹å¼é…ç½®

```java
@SpringBootApplication
@Slf4j
public class McpServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(McpServerApplication.class, args);
    }

    /**
     * è¨»å†Šæ•¸å­¸å·¥å…·
     */
    @Bean
    public ToolCallbackProvider mathTools(MathToolProvider mathToolProvider) {
        return MethodToolCallbackProvider.builder()
                .toolObjects(mathToolProvider)
                .build();
    }

    /**
     * è¨»å†Šå¤©æ°£å·¥å…·
     */
    @Bean
    public ToolCallbackProvider weatherTools(WeatherToolProvider weatherToolProvider) {
        return MethodToolCallbackProvider.builder()
                .toolObjects(weatherToolProvider)
                .build();
    }

    /**
     * è¨»å†Šæ–‡æœ¬å·¥å…·
     */
    @Bean
    public ToolCallbackProvider textTools(TextToolProvider textToolProvider) {
        return MethodToolCallbackProvider.builder()
                .toolObjects(textToolProvider)
                .build();
    }

    /**
     * è¨»å†Šæ™‚é–“å·¥å…·
     */
    @Bean
    public ToolCallbackProvider timeTools(TimeToolProvider timeToolProvider) {
        return MethodToolCallbackProvider.builder()
                .toolObjects(timeToolProvider)
                .build();
    }
}
```

**å°æ‡‰æª”æ¡ˆ**: `chapter9-mcp-server-tools-resources/src/main/java/com/example/mcp/server/McpServerApplication.java:53-97`

**è¨»å†Šæµç¨‹**:

```mermaid
graph LR
    A[Toolæ–¹æ³•] --> B[ToolProvider Service]
    B --> C[MethodToolCallbackProvider Builder]
    C --> D[ToolCallbackProvider Bean]
    D --> E[Spring AI MCP Server è‡ªå‹•æƒæ]
    E --> F[æš´éœ²ç‚º MCP Tools]

    style A fill:#e8f5e9
    style B fill:#fff4e6
    style C fill:#e1f5ff
    style D fill:#f3e5f5
    style E fill:#e8f5e9
    style F fill:#fff9c4
```

**é‡è¦æ¦‚å¿µ**:
- æ¯å€‹ `ToolCallbackProvider` Bean å°æ‡‰ä¸€çµ„å·¥å…·
- å¯ä»¥å°‡å¤šå€‹ Provider é¡åˆ¥å‚³çµ¦ `.toolObjects()` æ–¹æ³•
- Spring AI æœƒè‡ªå‹•åˆä½µæ‰€æœ‰ `ToolCallbackProvider` Bean
- å·¥å…·åç¨±é è¨­ç‚ºæ–¹æ³•åç¨±ï¼Œå¯é€é `@Tool(name = "...")` è‡ªå®šç¾©

---

## ğŸ”„ é›™å‚³è¼¸æ¨¡å¼æ”¯æ´

MCP Server æ”¯æ´å…©ç¨®å‚³è¼¸æ¨¡å¼ï¼Œé©ç”¨æ–¼ä¸åŒå ´æ™¯ã€‚

### STDIO æ¨¡å¼ï¼ˆæ¨™æº–è¼¸å…¥è¼¸å‡ºï¼‰

**é©ç”¨å ´æ™¯**:
- æœ¬åœ°é–‹ç™¼å’Œæ¸¬è©¦
- å‘½ä»¤è¡Œå·¥å…·æ•´åˆ
- ä½å»¶é²è¦æ±‚

**å•Ÿå‹•æ–¹å¼**:

```powershell
# æ–¹å¼ä¸€ï¼šä¿®æ”¹ application.yml
spring.ai.mcp.server.stdio: true

# æ–¹å¼äºŒï¼šä½¿ç”¨å•Ÿå‹•åƒæ•¸
mvn spring-boot:run -Dspring-boot.run.arguments="--spring.ai.mcp.server.stdio=true"
```

**é€šè¨Šæ–¹å¼**:
- é€éæ¨™æº–è¼¸å…¥ï¼ˆstdinï¼‰æ¥æ”¶ JSON-RPC è«‹æ±‚
- é€éæ¨™æº–è¼¸å‡ºï¼ˆstdoutï¼‰å›å‚³ JSON-RPC å›æ‡‰
- é©åˆæœ¬åœ°ç¨‹åºé–“é€šè¨Šï¼ˆIPCï¼‰

---

### SSE æ¨¡å¼ï¼ˆServer-Sent Eventsï¼‰

**é©ç”¨å ´æ™¯**:
- é ç«¯æœå‹™æ•´åˆ
- HTTP/Web ç’°å¢ƒ
- ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

**å•Ÿå‹•æ–¹å¼**:

```powershell
# é è¨­å³ç‚º SSE æ¨¡å¼
mvn spring-boot:run
```

**ç«¯é»é…ç½®**:
- HTTP ç«¯é»: `http://localhost:8080/mcp/message`
- æ”¯æ´ POST è«‹æ±‚å‚³é€ JSON-RPC
- å›æ‡‰æ ¼å¼: Server-Sent Events ä¸²æµ

**æ¸¬è©¦ç¯„ä¾‹**:

```bash
# æ¸¬è©¦ MCP Server å·¥å…·åˆ—è¡¨
curl -X POST http://localhost:8080/mcp/message \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/list",
    "params": {}
  }'
```

---

### å‚³è¼¸æ¨¡å¼æ¯”è¼ƒ

| ç‰¹æ€§ | STDIO æ¨¡å¼ | SSE æ¨¡å¼ |
|------|-----------|---------|
| **é€šè¨Šæ–¹å¼** | æ¨™æº–è¼¸å…¥/è¼¸å‡º | HTTP ç«¯é» |
| **ç¶²è·¯éœ€æ±‚** | ç„¡éœ€ç¶²è·¯ | éœ€è¦ HTTP é€£ç·š |
| **é©ç”¨ç’°å¢ƒ** | æœ¬åœ°é–‹ç™¼ã€CLI | é ç«¯æœå‹™ã€ç”Ÿç”¢ç’°å¢ƒ |
| **å»¶é²** | æ¥µä½ | ä¸­ç­‰ï¼ˆä¾ç¶²è·¯ï¼‰ |
| **èª¿è©¦æ–¹å¼** | å‘½ä»¤è¡Œæ—¥èªŒ | curlã€Postman |
| **å®‰å…¨æ€§** | åƒ…é™æœ¬åœ°è¨ªå• | éœ€é…ç½®èªè­‰æˆæ¬Š |
| **å¯æ“´å±•æ€§** | å–®ä¸€ç¨‹åº | æ”¯æ´åˆ†æ•£å¼éƒ¨ç½² |

---

## ğŸš€ å•Ÿå‹•å’Œæ¸¬è©¦

### ç·¨è­¯å°ˆæ¡ˆ

```powershell
# è¨­å®š Java 21 ç’°å¢ƒ
$env:JAVA_HOME="D:\java\jdk-21"
$env:Path="D:\java\jdk-21\bin;$env:Path"

# ç·¨è­¯
cd E:\Spring_AI_BOOK\code-examples\chapter9-mcp-integration\chapter9-mcp-server-tools-resources
mvn clean compile
```

---

### å•Ÿå‹• MCP Server

#### STDIO æ¨¡å¼

```powershell
mvn spring-boot:run -Dspring-boot.run.arguments="--spring.ai.mcp.server.stdio=true"
```

#### SSE æ¨¡å¼

```powershell
mvn spring-boot:run
```

**å•Ÿå‹•æˆåŠŸæ—¥èªŒ**:

```
========================================
  å•Ÿå‹• MCP Server - å·¥å…·èˆ‡è³‡æº
  Spring AI 1.0.3 ç©©å®šç‰ˆ
========================================
... Spring Boot å•Ÿå‹•æ—¥èªŒ ...
========================================
  MCP Server å·²å•Ÿå‹•å®Œæˆ
========================================
```

---

### å·¥å…·æ¸…å–®

æœ¬å°ˆæ¡ˆæä¾›çš„å·¥å…·ï¼š

| å·¥å…·åç¨± | Provider | èªªæ˜ | åƒæ•¸ |
|---------|----------|------|------|
| `sum` | MathToolProvider | è¨ˆç®—å¤šå€‹æ•¸å­—çš„ç¸½å’Œ | numbersï¼ˆå¯è®Šåƒæ•¸ï¼‰ |
| `multiply` | MathToolProvider | è¨ˆç®—å¤šå€‹æ•¸å­—çš„ä¹˜ç© | numbersï¼ˆå¯è®Šåƒæ•¸ï¼‰ |
| `divide` | MathToolProvider | å…©æ•¸ç›¸é™¤ | dividend, divisor |
| `sqrt` | MathToolProvider | è¨ˆç®—å¹³æ–¹æ ¹ | number |
| `getTemperature` | WeatherToolProvider | ç²å–å¤©æ°£æº«åº¦ | latitude, longitude, city |
| `toUpperCase` | TextToolProvider | è½‰æ›ç‚ºå¤§å¯« | text |
| `toLowerCase` | TextToolProvider | è½‰æ›ç‚ºå°å¯« | text |
| `wordCount` | TextToolProvider | è¨ˆç®—å–®å­—æ•¸é‡ | text |
| `getCurrentTime` | TimeToolProvider | ç²å–ç•¶å‰æ™‚é–“ | timezoneï¼ˆå¯é¸ï¼‰ |

---

### æ¸¬è©¦å·¥å…·èª¿ç”¨

ä½¿ç”¨ `chapter9-mcp-client-basic` å°ˆæ¡ˆæ¸¬è©¦ï¼š

```java
// åœ¨ MCP Client ä¸­èª¿ç”¨ MCP Server å·¥å…·
String response = chatClient.prompt()
    .user("å°åŒ—ç¾åœ¨çš„æº«åº¦æ˜¯å¤šå°‘ï¼Ÿç·¯åº¦25.0330ï¼Œç¶“åº¦121.5654")
    .call()
    .content();

// AI æœƒè‡ªå‹•èª¿ç”¨ getTemperature å·¥å…·
// å¯¦éš›è«‹æ±‚: getTemperature(25.0330, 121.5654, "å°åŒ—")
```

---

## ğŸ“ é‡é»å›é¡§

### æ ¸å¿ƒé–‹ç™¼æµç¨‹

```mermaid
graph TD
    A[1. é…ç½® Maven ä¾è³´ spring-ai-starter-mcp-server-webmvc]
    B[2. é…ç½® application.yml è¨­å®š Server åç¨±å’Œå‚³è¼¸æ¨¡å¼]
    C[3. å‰µå»º ToolProvider ä½¿ç”¨ Service è¨»è§£]
    D[4. å®šç¾© Tool æ–¹æ³• å¯¦ç¾å·¥å…·é‚è¼¯]
    E[5. è¨»å†Š ToolCallbackProvider ä½¿ç”¨ MethodToolCallbackProvider]
    F[6. å•Ÿå‹• MCP Server é¸æ“‡ STDIO æˆ– SSE æ¨¡å¼]
    G[7. æ¸¬è©¦å·¥å…·èª¿ç”¨ ä½¿ç”¨ MCP Client]

    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    F --> G

    style A fill:#e1f5ff
    style D fill:#e8f5e9
    style E fill:#fff4e6
    style F fill:#f3e5f5
```

---

### é—œéµæŠ€è¡“é»

| æŠ€è¡“é» | èªªæ˜ | é‡è¦æ€§ |
|--------|------|--------|
| `@Tool` è¨»è§£ | æ¨™è¨˜å¯èª¿ç”¨çš„å·¥å…·æ–¹æ³• | â­â­â­â­â­ |
| `MethodToolCallbackProvider` | è¨»å†Šå·¥å…·çš„å®˜æ–¹æ–¹å¼ | â­â­â­â­â­ |
| `WebClient` | æ•´åˆå¤–éƒ¨ API æœå‹™ | â­â­â­â­ |
| STDIO/SSE é›™æ¨¡å¼ | éˆæ´»é©æ‡‰ä¸åŒéƒ¨ç½²ç’°å¢ƒ | â­â­â­â­ |
| éŒ¯èª¤è™•ç† | ç¢ºä¿å·¥å…·èª¿ç”¨çš„ç©©å®šæ€§ | â­â­â­â­â­ |

---

### æœ€ä½³å¯¦è¸

1. **å·¥å…·æè¿°è¦æ¸…æ™°**ï¼š`@Tool(description = "...")` çš„æè¿°æœƒç›´æ¥å½±éŸ¿ AI å°å·¥å…·çš„é¸æ“‡
2. **åƒæ•¸é©—è­‰**ï¼šåœ¨å·¥å…·æ–¹æ³•ä¸­åŠ å…¥åƒæ•¸æª¢æŸ¥ï¼ˆå¦‚é™¤é›¶ã€è² æ•¸å¹³æ–¹æ ¹ï¼‰
3. **æ—¥èªŒè¨˜éŒ„**ï¼šè¨˜éŒ„å·¥å…·çš„èª¿ç”¨å’ŒåŸ·è¡Œçµæœï¼Œä¾¿æ–¼èª¿è©¦å’Œç›£æ§
4. **ç•°å¸¸è™•ç†**ï¼šæ•ç²ä¸¦è½‰æ›ç•°å¸¸ç‚ºæœ‰æ„ç¾©çš„éŒ¯èª¤è¨Šæ¯
5. **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šå°‡ä¸åŒé¡å‹çš„å·¥å…·åˆ†åˆ¥æ”¾åœ¨ä¸åŒçš„ Provider ä¸­
6. **å‚³è¼¸æ¨¡å¼é¸æ“‡**ï¼šé–‹ç™¼ç”¨ STDIOï¼Œç”Ÿç”¢ç”¨ SSE

---

## ğŸ”— å¯¦æˆ°æ‡‰ç”¨

### æ–°å¢è‡ªå®šç¾©å·¥å…·

å‡è¨­è¦æ–°å¢ä¸€å€‹ã€Œæ–‡ä»¶æœå°‹ã€å·¥å…·ï¼š

**æ­¥é©Ÿ 1**: å‰µå»º ToolProvider

```java
@Service
@Slf4j
public class DocumentToolProvider {

    @Tool(description = "Search documents by keyword")
    public String searchDocuments(String keyword, int limit) {
        log.info("æœå°‹æ–‡ä»¶: é—œéµå­—={}, é™åˆ¶={}", keyword, limit);

        // å¯¦ç¾æœå°‹é‚è¼¯ï¼ˆç¤ºç¯„ï¼‰
        List<String> results = performSearch(keyword, limit);

        return String.format("æ‰¾åˆ° %d å€‹çµæœ: %s", results.size(), results);
    }

    private List<String> performSearch(String keyword, int limit) {
        // å¯¦éš›æœå°‹å¯¦ä½œ
        return List.of("doc1.pdf", "doc2.docx", "doc3.txt")
            .stream()
            .limit(limit)
            .toList();
    }
}
```

**æ­¥é©Ÿ 2**: åœ¨ McpServerApplication ä¸­è¨»å†Š

```java
@Bean
public ToolCallbackProvider documentTools(DocumentToolProvider documentToolProvider) {
    return MethodToolCallbackProvider.builder()
            .toolObjects(documentToolProvider)
            .build();
}
```

å®Œæˆï¼å·¥å…·æœƒè‡ªå‹•æš´éœ²ç‚º MCP Toolï¼Œå¯è¢« Client èª¿ç”¨ã€‚

---

## ğŸš€ ä¸‹ä¸€æ­¥

ç¾åœ¨ä½ å·²ç¶“æŒæ¡äº† MCP Server çš„åŸºç¤å·¥å…·é–‹ç™¼ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å°‡å­¸ç¿’ï¼š

ğŸ‘‰ [9.4 MCP Server é€²éšç‰¹æ€§](./9.4-MCP-Server-é€²éšç‰¹æ€§.md) - Promptsã€Completionsã€å‹•æ…‹å·¥å…·æ›´æ–°

---

## ğŸ“š åƒè€ƒè³‡æº

### å®˜æ–¹æ–‡æª”
- [Spring AI MCP Server Documentation](https://docs.spring.io/spring-ai/reference/api/mcp/)
- [MCP Tools Specification](https://spec.modelcontextprotocol.io/specification/basic/tools/)
- [Spring AI @Tool Annotation](https://docs.spring.io/spring-ai/reference/api/functions.html)

### ç¯„ä¾‹å°ˆæ¡ˆ
- [æœ¬ç« ç¯„ä¾‹: chapter9-mcp-server-tools-resources](../../code-examples/chapter9-mcp-integration/chapter9-mcp-server-tools-resources/)
- [Spring AI Examples - MCP Server](https://github.com/spring-projects/spring-ai-examples/tree/main/model-context-protocol)

---

**ç›¸é—œç« ç¯€**:
- â† ä¸Šä¸€ç« : [9.2 MCP Client ä½¿ç”¨](./9.2-MCP-Client-ä½¿ç”¨.md)
- â†’ ä¸‹ä¸€ç« : [9.4 MCP Server é€²éšç‰¹æ€§](./9.4-MCP-Server-é€²éšç‰¹æ€§.md)
- â† å›åˆ°: [ç¬¬9ç« ç¸½è¦½](./README.md)
