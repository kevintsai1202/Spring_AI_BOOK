# 9.1 甚麼是 MCP？

> **本章重點**：深入了解 Model Context Protocol (MCP) 的核心概念、架構設計和在企業 AI 應用中的重要價值，掌握 MCP 如何解決 AI 系統互操作性問題，為後續的 Spring AI MCP 整合奠定理論基礎。

## 🎯 學習目標

完成本章學習後，您將能夠：

- 🎯 **理解 MCP 核心概念**：掌握 Model Context Protocol 的基本原理和設計思想
- 🎯 **認識 MCP 架構**：了解 MCP 的系統架構和各組件的職責
- 🎯 **掌握 MCP 協議規範**：熟悉 MCP 的通訊協議和資料格式
- 🎯 **理解企業應用價值**：認識 MCP 在企業 AI 系統中的重要作用
- 🎯 **為實作做準備**：建立 Spring AI MCP 開發的知識基礎

---

## 9.1.1 MCP 是什麼？

### Model Context Protocol 簡介

**Model Context Protocol (MCP)** 是一個開放標準協議，專門設計用於解決 AI 模型與外部工具、資源和服務之間的互操作性問題。它提供了一個統一的框架，讓不同的 AI 系統能夠以標準化的方式存取和使用各種外部功能。

**MCP 的核心價值**：
```
┌─────────────────────────────────────────────────────────────┐
│                    MCP 解決的核心問題                       │
├─────────────────────────────────────────────────────────────┤
│  問題：AI 系統孤島化                                       │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  • 不同 AI 工具無法互相溝通                             │ │
│  │  • 重複開發相似功能                                     │ │
│  │  • 缺乏標準化介面                                       │ │
│  │  • 整合成本高昂                                         │ │
│  └─────────────────────────────────────────────────────────┘ │
│                            ↓                                │
│  解決方案：MCP 標準化協議                                   │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  • 統一的通訊協議                                       │ │
│  │  • 標準化的資料格式                                     │ │
│  │  • 可重用的工具和資源                                   │ │
│  │  • 簡化的系統整合                                       │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### MCP 的設計理念

#### 1. 標準化優先
- **統一協議**：所有 MCP 服務都遵循相同的通訊協議
- **標準格式**：使用 JSON-RPC 2.0 作為基礎通訊格式
- **一致性介面**：提供統一的 API 設計模式

#### 2. 互操作性
- **跨平台支援**：支援不同作業系統和程式語言
- **協議無關**：可以透過 HTTP、WebSocket、SSE 等多種傳輸方式
- **版本相容**：向後相容的協議版本管理

#### 3. 可擴展性
- **模組化設計**：支援工具、資源、提示等不同類型的服務
- **動態發現**：客戶端可以動態發現和使用新的服務
- **彈性配置**：支援靈活的服務配置和管理

---

## 9.1.2 MCP 架構設計

### 整體架構概覽

```
┌─────────────────────────────────────────────────────────────┐
│                      MCP 系統架構                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    MCP Protocol    ┌─────────────────────┐ │
│  │             │ ←─────────────────→ │                     │ │
│  │ MCP Client  │                     │    MCP Server       │ │
│  │             │    JSON-RPC 2.0     │                     │ │
│  │ • AI 應用   │ ←─────────────────→ │ • 工具提供者        │ │
│  │ • 聊天機器人│                     │ • 資源管理器        │ │
│  │ • RAG 系統  │                     │ • 提示服務          │ │
│  └─────────────┘                     └─────────────────────┘ │
│                                                             │
│  傳輸層選項：                                               │
│  • HTTP/HTTPS                                               │
│  • WebSocket                                                │
│  • Server-Sent Events (SSE)                                │
│  • 本地進程通訊                                             │
└─────────────────────────────────────────────────────────────┘
```

### 核心組件說明

#### MCP Client（客戶端）
**職責**：
- 發起對 MCP Server 的連接和請求
- 發現和使用可用的工具、資源和提示
- 管理與多個 MCP Server 的連接
- 處理回應和錯誤

**典型應用場景**：
- AI 聊天應用
- RAG 知識庫系統
- 智能助手
- 自動化工具

#### MCP Server（伺服器）
**職責**：
- 提供工具、資源和提示服務
- 處理客戶端請求
- 管理服務的生命週期
- 確保服務的安全性和穩定性

**服務類型**：
- **Tools（工具）**：可執行的功能，如檔案操作、API 呼叫
- **Resources（資源）**：可讀取的資料，如文件、資料庫記錄
- **Prompts（提示）**：預定義的提示模板

---

## 9.1.3 MCP 協議規範

### JSON-RPC 2.0 基礎

MCP 基於 JSON-RPC 2.0 協議，提供了結構化的通訊格式：

```json
{
  "jsonrpc": "2.0",
  "method": "tools/list",
  "params": {},
  "id": 1
}
```

### 核心協議方法

#### 1. 初始化協議
```json
// 客戶端初始化請求
{
  "jsonrpc": "2.0",
  "method": "initialize",
  "params": {
    "protocolVersion": "2025-06-18",
    "capabilities": {
      "tools": {},
      "resources": {},
      "prompts": {}
    },
    "clientInfo": {
      "name": "Spring AI MCP Client",
      "version": "1.0.0"
    }
  },
  "id": 1
}

// 伺服器回應
{
  "jsonrpc": "2.0",
  "result": {
    "protocolVersion": "2025-06-18",
    "capabilities": {
      "tools": {
        "listChanged": true
      },
      "resources": {
        "subscribe": true,
        "listChanged": true
      },
      "prompts": {
        "listChanged": true
      }
    },
    "serverInfo": {
      "name": "Enterprise MCP Server",
      "version": "1.0.0"
    }
  },
  "id": 1
}
```

#### 2. 工具相關協議
```json
// 列出可用工具
{
  "jsonrpc": "2.0",
  "method": "tools/list",
  "params": {},
  "id": 2
}

// 工具列表回應
{
  "jsonrpc": "2.0",
  "result": {
    "tools": [
      {
        "name": "search_documents",
        "description": "搜尋企業文檔",
        "inputSchema": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "搜尋關鍵字"
            },
            "limit": {
              "type": "number",
              "description": "結果數量限制",
              "default": 10
            }
          },
          "required": ["query"]
        }
      }
    ]
  },
  "id": 2
}

// 執行工具
{
  "jsonrpc": "2.0",
  "method": "tools/call",
  "params": {
    "name": "search_documents",
    "arguments": {
      "query": "Spring AI 教學",
      "limit": 5
    }
  },
  "id": 3
}
```

#### 3. 資源相關協議
```json
// 列出可用資源
{
  "jsonrpc": "2.0",
  "method": "resources/list",
  "params": {},
  "id": 4
}

// 讀取資源
{
  "jsonrpc": "2.0",
  "method": "resources/read",
  "params": {
    "uri": "file:///docs/spring-ai-guide.md"
  },
  "id": 5
}
```

#### 4. 提示相關協議
```json
// 列出可用提示
{
  "jsonrpc": "2.0",
  "method": "prompts/list",
  "params": {},
  "id": 6
}

// 獲取提示
{
  "jsonrpc": "2.0",
  "method": "prompts/get",
  "params": {
    "name": "code_review",
    "arguments": {
      "language": "java",
      "code": "public class Example { ... }"
    }
  },
  "id": 7
}
```

---

## 9.1.4 MCP 在企業中的應用價值

### 解決企業 AI 系統的核心挑戰

#### 1. 系統整合複雜性
**傳統問題**：
- 每個 AI 工具都有自己的 API 格式
- 需要為每個整合編寫專門的適配器
- 維護成本隨著工具數量指數增長

**MCP 解決方案**：
- 統一的協議標準，一次整合，處處可用
- 標準化的工具發現和調用機制
- 大幅降低整合和維護成本

#### 2. 功能重複開發
**傳統問題**：
- 不同團隊重複開發相似功能
- 缺乏有效的功能共享機制
- 資源浪費和效率低下

**MCP 解決方案**：
- 工具和資源的標準化封裝
- 跨團隊、跨專案的功能共享
- 建立企業級的 AI 工具生態系統

#### 3. 可擴展性限制
**傳統問題**：
- 新增功能需要修改核心系統
- 系統架構缺乏彈性
- 難以適應快速變化的業務需求

**MCP 解決方案**：
- 插件式的架構設計
- 動態的服務發現和載入
- 無需修改核心系統即可擴展功能

### 企業應用場景

#### 1. 智能客服系統
```
客服機器人 (MCP Client)
    ↓
┌─────────────────────────────────────┐
│ MCP Server 生態系統                 │
├─────────────────────────────────────┤
│ • 知識庫搜尋服務                    │
│ • 訂單查詢工具                      │
│ • 客戶資料存取                      │
│ • 工單建立系統                      │
│ • 情感分析服務                      │
└─────────────────────────────────────┘
```

#### 2. 企業知識管理
```
RAG 知識庫 (MCP Client)
    ↓
┌─────────────────────────────────────┐
│ MCP Server 生態系統                 │
├─────────────────────────────────────┤
│ • 文檔檢索服務                      │
│ • 內容分析工具                      │
│ • 版本控制系統                      │
│ • 權限管理服務                      │
│ • 內容推薦引擎                      │
└─────────────────────────────────────┘
```

#### 3. 開發輔助工具
```
AI 程式助手 (MCP Client)
    ↓
┌─────────────────────────────────────┐
│ MCP Server 生態系統                 │
├─────────────────────────────────────┤
│ • 程式碼分析工具                    │
│ • 測試生成服務                      │
│ • 文檔生成器                        │
│ • 程式碼審查系統                    │
│ • 部署自動化工具                    │
└─────────────────────────────────────┘
```

---

## 9.1.5 MCP vs 其他解決方案

### 技術比較

| 特性 | MCP | REST API | GraphQL | gRPC |
|------|-----|----------|---------|------|
| **標準化程度** | 高 | 中 | 中 | 高 |
| **AI 特化** | 是 | 否 | 否 | 否 |
| **動態發現** | 支援 | 有限 | 有限 | 有限 |
| **類型安全** | 支援 | 有限 | 支援 | 支援 |
| **實時通訊** | 支援 | 有限 | 支援 | 支援 |
| **學習成本** | 中 | 低 | 中 | 高 |
| **生態成熟度** | 新興 | 成熟 | 成熟 | 成熟 |

### MCP 的獨特優勢

#### 1. AI 原生設計
- 專門為 AI 應用場景設計
- 內建工具、資源、提示的概念模型
- 支援 AI 特有的互動模式

#### 2. 標準化工具生態
- 統一的工具描述格式
- 標準化的參數驗證
- 一致的錯誤處理機制

#### 3. 動態能力發現
- 運行時發現可用服務
- 自動適應服務變更
- 支援服務的熱插拔

#### 4. 多傳輸協議支援
- HTTP/HTTPS for RESTful 整合
- WebSocket for 即時通訊
- SSE for 伺服器推送
- 本地進程通訊 for 高效能場景

---

## 📝 本章重點回顧

1. **MCP 核心概念**：理解了 Model Context Protocol 的基本原理和設計思想
2. **架構設計**：掌握了 MCP 的系統架構和各組件的職責分工
3. **協議規範**：熟悉了基於 JSON-RPC 2.0 的通訊協議和資料格式
4. **企業價值**：認識了 MCP 在解決企業 AI 系統整合問題中的重要作用
5. **應用場景**：了解了 MCP 在不同企業場景中的具體應用方式

### 核心概念總結

| 概念 | 說明 | 重要性 |
|------|------|--------|
| **MCP 協議** | 標準化的 AI 工具通訊協議 | ⭐⭐⭐⭐⭐ |
| **Client-Server 架構** | 客戶端-伺服器的分離式設計 | ⭐⭐⭐⭐ |
| **JSON-RPC 2.0** | 基礎通訊協議格式 | ⭐⭐⭐⭐ |
| **工具、資源、提示** | MCP 的三大服務類型 | ⭐⭐⭐⭐⭐ |
| **動態發現** | 運行時服務發現機制 | ⭐⭐⭐ |

### MCP 的核心價值

1. **標準化**：統一的協議規範，降低整合複雜度
2. **互操作性**：不同系統間的無縫協作
3. **可擴展性**：靈活的插件式架構
4. **重用性**：工具和資源的跨專案共享
5. **維護性**：簡化的系統維護和升級

### 下一步學習方向

在下一節中，我們將學習如何在 Spring AI 中引入 MCP 支援，包括：
- Spring AI MCP 依賴配置
- MCP Client 和 Server 的基礎設置
- 與現有 Spring AI 功能的整合
- 開發環境的準備和配置

---

**參考資料：**
- [Model Context Protocol Specification](https://spec.modelcontextprotocol.io/)
- [JSON-RPC 2.0 Specification](https://www.jsonrpc.org/specification)
- [Spring AI MCP Documentation](https://docs.spring.io/spring-ai/reference/api/mcp.html)
- [MCP GitHub Repository](https://github.com/modelcontextprotocol)