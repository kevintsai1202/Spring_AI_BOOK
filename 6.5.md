# 6.5 Spring AI æ“´å±•æ©Ÿåˆ¶ï¼šAdvisors èˆ‡ Tools é–‹ç™¼

> **æœ¬ç« é‡é»**ï¼šå­¸ç¿’ Spring AI çš„å®˜æ–¹æ“´å±•æ©Ÿåˆ¶ï¼ŒåŒ…æ‹¬ Advisors API å’Œ Tools é–‹ç™¼ï¼Œå¾åŸºç¤æ¦‚å¿µåˆ°å¯¦éš›æ‡‰ç”¨ï¼Œå»ºç«‹å¼·å¤§çš„ AI å¢å¼·åŠŸèƒ½ã€‚

## ğŸ¯ å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬ç« å­¸ç¿’å¾Œï¼Œæ‚¨å°‡èƒ½å¤ ï¼š

- ğŸ¯ **æŒæ¡ Advisors æ¶æ§‹**ï¼šç†è§£ Spring AI Advisors ç³»çµ±çš„è¨­è¨ˆåŸç†å’ŒåŸ·è¡Œæµç¨‹
- ğŸ¯ **é–‹ç™¼è‡ªå®šç¾© Advisors**ï¼šå­¸æœƒå‰µå»ºè«‹æ±‚/éŸ¿æ‡‰æ””æˆªå™¨å’Œæ•¸æ“šè½‰æ›å™¨
- ğŸ¯ **å¯¦ç¾ Tools åŠŸèƒ½**ï¼šæŒæ¡å·¥å…·èª¿ç”¨æ©Ÿåˆ¶ï¼Œæ•´åˆå¤–éƒ¨ API å’Œæœå‹™
- ğŸ¯ **ç®¡ç†æ“´å±•ç”Ÿå‘½é€±æœŸ**ï¼šç†è§£æ“´å±•çš„è¼‰å…¥ã€åŸ·è¡Œé †åºå’Œä¸Šä¸‹æ–‡ç®¡ç†
- ğŸ¯ **æ•´åˆç¬¬ä¸‰æ–¹æœå‹™**ï¼šå°‡å¤–éƒ¨æœå‹™å’Œ API æ•´åˆåˆ° Spring AI ç”Ÿæ…‹ä¸­

---

## 6.5.1 Spring AI æ“´å±•æ¶æ§‹æ¦‚è¿°

### æ“´å±•ç³»çµ±çš„è¨­è¨ˆç†å¿µ

Spring AI æ¡ç”¨å¤šå±¤æ¬¡æ“´å±•æ©Ÿåˆ¶ï¼Œæä¾›éˆæ´»çš„å¢å¼·é»ä¾†æ“´å±• AI æ‡‰ç”¨åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒæ¡†æ¶ã€‚

**æ ¸å¿ƒè¨­è¨ˆåŸå‰‡**ï¼š
- ğŸ”Œ **å¤šé‡æ“´å±•é»**ï¼šAdvisorsã€Toolsã€ETL Pipeline ç­‰ä¸åŒå±¤æ¬¡çš„æ“´å±•
- ğŸ—ï¸ **æ¨™æº–åŒ–ä»‹é¢**ï¼šçµ±ä¸€çš„æ“´å±•é–‹ç™¼è¦ç¯„å’Œ API
- ğŸ”„ **éˆå¼åŸ·è¡Œ**ï¼šæ”¯æ´å¤šå€‹æ“´å±•çµ„ä»¶çš„æœ‰åºåŸ·è¡Œ
- ğŸ›¡ï¸ **é¡å‹å®‰å…¨**ï¼šå¼·é¡å‹ä»‹é¢è¨­è¨ˆï¼Œç¢ºä¿æ“´å±•å®‰å…¨æ€§
- ğŸ“¦ **Spring æ•´åˆ**ï¼šå®Œæ•´çš„ Spring Boot è‡ªå‹•é…ç½®æ”¯æ´

### Spring AI æ“´å±•æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Spring AI Extension Architecture               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Application Layer                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   ChatClient    â”‚    â”‚   ChatModel     â”‚               â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension Layer                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Advisors Chain                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ CallAroundAdvisor                            â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ StreamAroundAdvisor                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ Chain Execution & Context Management        â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Tools System                               â”‚ â”‚
â”‚  â”‚  â€¢ ToolCallback Interface                              â”‚ â”‚
â”‚  â”‚  â€¢ ToolCallingManager                                  â”‚ â”‚
â”‚  â”‚  â€¢ Method-based Tools (@Tool)                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Implementation Layer                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Custom       â”‚ â”‚Memory       â”‚ â”‚RAG          â”‚          â”‚
â”‚  â”‚Advisors     â”‚ â”‚Advisors     â”‚ â”‚Advisors     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚Weather      â”‚ â”‚Database     â”‚ â”‚External API â”‚          â”‚
â”‚  â”‚Tools        â”‚ â”‚Tools        â”‚ â”‚Tools        â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6.5.2 Advisors API åŸºç¤æ¡†æ¶

### æ ¸å¿ƒ Advisor ä»‹é¢å®šç¾©

```java
/**
 * Spring AI Advisor åŸºç¤ä»‹é¢
 */
public interface Advisor extends Ordered {
    
    /**
     * Advisor å”¯ä¸€åç¨±
     */
    String getName();
    
    /**
     * åŸ·è¡Œé †åºï¼Œæ•¸å€¼è¶Šå°å„ªå…ˆç´šè¶Šé«˜
     */
    int getOrder();
}

/**
 * åŒæ­¥èª¿ç”¨ Advisor ä»‹é¢
 */
public interface CallAroundAdvisor extends Advisor {
    
    /**
     * ç’°ç¹é€šçŸ¥ï¼Œæ””æˆª ChatModel.call() æ–¹æ³•
     * @param advisedRequest è«‹æ±‚ç‰©ä»¶
     * @param chain advisor éˆ
     * @return éŸ¿æ‡‰ç‰©ä»¶
     */
    AdvisedResponse aroundCall(AdvisedRequest advisedRequest, CallAroundAdvisorChain chain);
}

/**
 * æµå¼èª¿ç”¨ Advisor ä»‹é¢
 */
public interface StreamAroundAdvisor extends Advisor {
    
    /**
     * ç’°ç¹é€šçŸ¥ï¼Œæ””æˆª ChatModel.stream() æ–¹æ³•
     * @param advisedRequest è«‹æ±‚ç‰©ä»¶
     * @param chain advisor éˆ
     * @return éŸ¿æ‡‰æµ
     */
    Flux<AdvisedResponse> aroundStream(AdvisedRequest advisedRequest, StreamAroundAdvisorChain chain);
}

/**
 * Advisor éˆä»‹é¢ - åŒæ­¥
 */
public interface CallAroundAdvisorChain {
    AdvisedResponse nextAroundCall(AdvisedRequest advisedRequest);
}

/**
 * Advisor éˆä»‹é¢ - ç•°æ­¥
 */
public interface StreamAroundAdvisorChain {
    Flux<AdvisedResponse> nextAroundStream(AdvisedRequest advisedRequest);
}
```

### Advisors åŸ·è¡Œæµç¨‹ç®¡ç†

```java
/**
 * AdvisedRequest - åŒ…è£çš„è«‹æ±‚ç‰©ä»¶
 */
public record AdvisedRequest(
    Prompt prompt,
    String userText,
    Map<String, Object> userParams,
    Map<String, Object> systemParams,
    Map<String, Object> advisorContext
) {
    
    /**
     * æ›´æ–°ä¸Šä¸‹æ–‡
     */
    public AdvisedRequest updateContext(Function<Map<String, Object>, Map<String, Object>> contextUpdater) {
        Map<String, Object> updatedContext = contextUpdater.apply(new HashMap<>(advisorContext));
        return new AdvisedRequest(prompt, userText, userParams, systemParams, Map.copyOf(updatedContext));
    }
    
    /**
     * å»ºé€ è€…æ¨¡å¼
     */
    public static Builder from(AdvisedRequest request) {
        return new Builder(request);
    }
}

/**
 * AdvisedResponse - åŒ…è£çš„éŸ¿æ‡‰ç‰©ä»¶
 */
public record AdvisedResponse(
    ChatCompletion chatCompletion,
    Map<String, Object> advisorContext
) {
    
    /**
     * å–å¾—éŸ¿æ‡‰å…§å®¹
     */
    public String content() {
        return chatCompletion.content();
    }
}
/**
 * MessageAggregator - æ¶ˆæ¯èšåˆå™¨å·¥å…·é¡
 */
public class MessageAggregator {
    
    /**
     * èšåˆæµå¼éŸ¿æ‡‰ç‚ºå–®ä¸€éŸ¿æ‡‰
     */
    public Flux<AdvisedResponse> aggregateAdvisedResponse(
            Flux<AdvisedResponse> advisedResponses, 
            Consumer<AdvisedResponse> onComplete) {
        
        return advisedResponses
            .buffer() // é›†åˆæ‰€æœ‰éŸ¿æ‡‰
            .map(responses -> {
                // åˆä½µæ‰€æœ‰éŸ¿æ‡‰å…§å®¹
                StringBuilder combinedContent = new StringBuilder();
                Map<String, Object> finalContext = new HashMap<>();
                
                for (AdvisedResponse response : responses) {
                    combinedContent.append(response.content());
                    finalContext.putAll(response.advisorContext());
                }
                
                AdvisedResponse aggregated = new AdvisedResponse(
                    new ChatCompletion(combinedContent.toString()),
                    finalContext
                );
                
                onComplete.accept(aggregated);
                return aggregated;
            })
            .flatMapIterable(response -> List.of(response));
    }
}
/**
 * è‡ªå®šç¾© Advisor é…ç½®é¡
 */
@Component
@Slf4j
public class AdvisorConfiguration {
    
    /**
     * é…ç½® ChatClient çš„é è¨­ Advisors
     */
    @Bean
    public ChatClient chatClient(
            ChatModel chatModel,
            ChatMemory chatMemory,
            VectorStore vectorStore) {
        
        return ChatClient.builder(chatModel)
            .defaultAdvisors(
                // è¨˜æ†¶ç®¡ç† Advisor
                MessageChatMemoryAdvisor.builder(chatMemory).build(),
                
                // RAG å•ç­” Advisor  
                QuestionAnswerAdvisor.builder(vectorStore).build(),
                
                // è‡ªå®šç¾©æ—¥èªŒ Advisor
                new SimpleLoggerAdvisor(),
                
                // Re-Reading Advisor
                new ReReadingAdvisor()
            )
            .build();
    }
}
/**
 * Spring AI å…§å»º Advisors
 */
public class BuiltInAdvisors {
    
    /**
     * è¨˜æ†¶ç®¡ç† Advisor - ç‚ºå°è©±æä¾›ä¸Šä¸‹æ–‡è¨˜æ†¶
     */
    public static class MessageChatMemoryAdvisor implements CallAroundAdvisor, StreamAroundAdvisor {
        
        private final ChatMemory chatMemory;
        
        public MessageChatMemoryAdvisor(ChatMemory chatMemory) {
            this.chatMemory = chatMemory;
        }
        
        @Override
        public String getName() {
            return "MessageChatMemoryAdvisor";
        }
        
        @Override
        public int getOrder() {
            return 100; // é è¨­å„ªå…ˆç´š
        }
        
        @Override
        public AdvisedResponse aroundCall(AdvisedRequest request, CallAroundAdvisorChain chain) {
            // å¾è¨˜æ†¶ä¸­æ¢å¾©æ­·å²å°è©±
            String conversationId = (String) request.userParams().get(ChatMemory.CONVERSATION_ID);
            List<Message> history = chatMemory.get(conversationId);
            
            // å°‡æ­·å²åŠ å…¥è«‹æ±‚
            Prompt enhancedPrompt = new Prompt(history);
            AdvisedRequest enhancedRequest = AdvisedRequest.from(request)
                .prompt(enhancedPrompt)
                .build();
            
            // ç¹¼çºŒåŸ·è¡Œéˆ
            AdvisedResponse response = chain.nextAroundCall(enhancedRequest);
            
            // å°‡æ–°çš„å°è©±å„²å­˜åˆ°è¨˜æ†¶ä¸­
            chatMemory.add(conversationId, request.userText(), response.content());
            
            return response;
        }
        
        @Override
        public Flux<AdvisedResponse> aroundStream(AdvisedRequest request, StreamAroundAdvisorChain chain) {
            // ç°¡åŒ–ç‰ˆæœ¬ï¼Œå¯¦éš›å¯¦ä½œæœƒæ›´è¤‡é›œ
            return chain.nextAroundStream(request);
        }
        
        public static Builder builder(ChatMemory chatMemory) {
            return new Builder(chatMemory);
        }
        
        public static class Builder {
            private final ChatMemory chatMemory;
            
            public Builder(ChatMemory chatMemory) {
                this.chatMemory = chatMemory;
            }
            
            public MessageChatMemoryAdvisor build() {
                return new MessageChatMemoryAdvisor(chatMemory);
            }
        }
    }
    
    /**
     * RAG å•ç­” Advisor - æä¾›æª¢ç´¢å¢å¼·ç”¢ç”ŸåŠŸèƒ½
     */
    public static class QuestionAnswerAdvisor implements CallAroundAdvisor, StreamAroundAdvisor {
        
        private final VectorStore vectorStore;
        
        public QuestionAnswerAdvisor(VectorStore vectorStore) {
            this.vectorStore = vectorStore;
        }
        
        @Override
        public String getName() {
            return "QuestionAnswerAdvisor";
        }
        
        @Override
        public int getOrder() {
            return 200;
        }
        
        @Override
        public AdvisedResponse aroundCall(AdvisedRequest request, CallAroundAdvisorChain chain) {
            // å¾å‘é‡è³‡æ–™åº«æª¢ç´¢ç›¸é—œæ–‡æª”
            List<Document> relevantDocs = vectorStore.similaritySearch(
                SearchRequest.query(request.userText()).withTopK(5)
            );
            
            // å°‡ç›¸é—œæ–‡æª”åŠ å…¥ç³»çµ±æç¤º
            String context = relevantDocs.stream()
                .map(Document::getContent)
                .collect(Collectors.joining("\n"));
                
            String systemMessage = "Based on the following context, please answer the user's question:\n" + context;
            
            AdvisedRequest enhancedRequest = AdvisedRequest.from(request)
                .systemParams(Map.of("context", context))
                .build();
            
            return chain.nextAroundCall(enhancedRequest);
        }
        
        @Override
        public Flux<AdvisedResponse> aroundStream(AdvisedRequest request, StreamAroundAdvisorChain chain) {
            // ç°¡åŒ–ç‰ˆæœ¬
            return chain.nextAroundStream(request);
        }
        
        public static Builder builder(VectorStore vectorStore) {
            return new Builder(vectorStore);
        }
        
        public static class Builder {
            private final VectorStore vectorStore;
            
            public Builder(VectorStore vectorStore) {
                this.vectorStore = vectorStore;
            }
            
            public QuestionAnswerAdvisor build() {
                return new QuestionAnswerAdvisor(vectorStore);
            }
        }
    }
}
```

---

## 6.5.3 å¯¦æˆ°ï¼šé–‹ç™¼è‡ªå®šç¾© Advisor

### ç°¡å–®æ—¥èªŒ Advisor

```java
/**
 * ç°¡å–®æ—¥èªŒ Advisor - è¨˜éŒ„è«‹æ±‚å’ŒéŸ¿æ‡‰
 */
@Component
@Slf4j
public class SimpleLoggerAdvisor implements CallAroundAdvisor, StreamAroundAdvisor {
    
    @Override
    public String getName() {
        return "SimpleLoggerAdvisor";
    }
    
    @Override
    public int getOrder() {
        return 0; // é«˜å„ªå…ˆç´šï¼Œç‡å…ˆåŸ·è¡Œ
    }
    
    @Override
    public AdvisedResponse aroundCall(AdvisedRequest advisedRequest, CallAroundAdvisorChain chain) {
        
        log.debug("BEFORE CALL: User={}, Context={}", 
            advisedRequest.userText(), 
            advisedRequest.advisorContext());
        
        // è¨˜éŒ„è«‹æ±‚æ™‚é–“
        long startTime = System.currentTimeMillis();
        
        AdvisedResponse advisedResponse = chain.nextAroundCall(advisedRequest);
        
        long duration = System.currentTimeMillis() - startTime;
        
        log.debug("AFTER CALL: Response={}, Duration={}ms", 
            advisedResponse.content().substring(0, Math.min(100, advisedResponse.content().length())), 
            duration);
        
        return advisedResponse;
    }
    
    @Override
    public Flux<AdvisedResponse> aroundStream(AdvisedRequest advisedRequest, StreamAroundAdvisorChain chain) {
        
        log.debug("BEFORE STREAM: User={}", advisedRequest.userText());
        
        Flux<AdvisedResponse> advisedResponses = chain.nextAroundStream(advisedRequest);
        
        // ä½¿ç”¨ MessageAggregator æ•´åˆæµå¼éŸ¿æ‡‰é€²è¡Œæ—¥èªŒè¨˜éŒ„
        return new MessageAggregator().aggregateAdvisedResponse(advisedResponses,
            advisedResponse -> log.debug("AFTER STREAM: {}", 
                advisedResponse.content().substring(0, Math.min(100, advisedResponse.content().length()))
            )
        );
    }
}
```

### Re-Reading (Re2) Advisor

```java
/**
 * Re-Reading Advisor - å¯¦ç¾ Re2 æŠ€è¡“æå‡æ¨ç†èƒ½åŠ›
 */
@Component
@Slf4j  
public class ReReadingAdvisor implements CallAroundAdvisor, StreamAroundAdvisor {
    
    @Override
    public String getName() {
        return "ReReadingAdvisor";
    }
    
    @Override
    public int getOrder() {
        return 50; // ä¸­ç­‰å„ªå…ˆç´š
    }
    
    /**
     * é è™•ç†æ–¹æ³• - å°‡ Re2 æŠ€è¡“æ‡‰ç”¨åˆ°ä½¿ç”¨è€…è¼¸å…¥
     */
    private AdvisedRequest before(AdvisedRequest advisedRequest) {
        
        Map<String, Object> advisedUserParams = new HashMap<>(advisedRequest.userParams());
        advisedUserParams.put("re2_input_query", advisedRequest.userText());
        
        return AdvisedRequest.from(advisedRequest)
            .userText("""
                {re2_input_query}
                Read the question again: {re2_input_query}
                """)
            .userParams(advisedUserParams)
            .build();
    }
    
    @Override
    public AdvisedResponse aroundCall(AdvisedRequest advisedRequest, CallAroundAdvisorChain chain) {
        return chain.nextAroundCall(this.before(advisedRequest));
    }
    
    @Override
    public Flux<AdvisedResponse> aroundStream(AdvisedRequest advisedRequest, StreamAroundAdvisorChain chain) {
        return chain.nextAroundStream(this.before(advisedRequest));
    }
}
```

---

## 6.5.4 Tools é–‹ç™¼å¯¦æˆ°

### å¤©æ°£æŸ¥è©¢å·¥å…·é–‹ç™¼

```java
/**
 * å¤©æ°£æŸ¥è©¢å·¥å…·é¡
 */
@Component
@Slf4j
public class WeatherTools {
    
    private final WeatherService weatherService;
    
    public WeatherTools() {
        // åˆå§‹åŒ–å¤©æ°£æœå‹™ï¼ˆå¯¦éš›æ‡‰ç”¨ä¸­æ‡‰ä½¿ç”¨é…ç½®æ³¨å…¥ï¼‰
        String apiKey = System.getenv("WEATHER_API_KEY");
        String baseUrl = "https://api.openweathermap.org/data/2.5";
        this.weatherService = new WeatherService(apiKey, baseUrl);
    }
    
    /**
     * å–å¾—ç•¶å‰å¤©æ°£ - ä½¿ç”¨ @Tool è¨»è§£
     */
    @Tool(description = "Get current weather information for a specific location")
    public WeatherInfo getCurrentWeather(WeatherRequest request) {
        try {
            log.debug("Getting current weather for: {}", request.location());
            
            WeatherInfo weather = weatherService.getCurrentWeather(
                request.location(),
                request.unit()
            );
            
            log.debug("Weather retrieved successfully for: {}", request.location());
            return weather;
            
        } catch (Exception e) {
            log.error("Failed to get weather for: {}", request.location(), e);
            throw new RuntimeException("Failed to get weather information", e);
        }
    }
    
    /**
     * å–å¾—å¤©æ°£é å ±
     */
    @Tool(description = "Get weather forecast for a specific location")
    public List<WeatherForecast> getWeatherForecast(ForecastRequest request) {
        try {
            log.debug("Getting weather forecast for: {}", request.location());
            
            List<WeatherForecast> forecast = weatherService.getWeatherForecast(
                request.location(),
                request.days(),
                request.unit()
            );
            
            log.debug("Weather forecast retrieved successfully for: {}", request.location());
            return forecast;
            
        } catch (Exception e) {
            log.error("Failed to get weather forecast for: {}", request.location(), e);
            throw new RuntimeException("Failed to get weather forecast", e);
        }
    }
    
    /**
     * è¨­å®šé¬§é˜ - è¡Œå‹•é¡å·¥å…·
     */
    @Tool(description = "Set an alarm for the given time, provided in ISO-8601 format")
    public String setAlarm(String time) {
        try {
            LocalDateTime alarmTime = LocalDateTime.parse(time, DateTimeFormatter.ISO_DATE_TIME);
            log.info("Alarm set for {}", alarmTime);
            
            // å¯¦éš›æ‡‰ç”¨ä¸­é€™è£¡æœƒæ•´åˆçœŸå¯¦çš„é¬§é˜ç³»çµ±
            return String.format("Alarm successfully set for %s", alarmTime.format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm")));
            
        } catch (Exception e) {
            log.error("Failed to set alarm for time: {}", time, e);
            throw new RuntimeException("Failed to set alarm", e);
        }
    }
    
    /**
     * å–å¾—ç•¶å‰æ™‚é–“ - è³‡è¨Šæª¢ç´¢é¡å·¥å…·
     */
    @Tool(description = "Get the current date and time in the user's timezone")
    public String getCurrentDateTime() {
        return LocalDateTime.now()
            .atZone(LocaleContextHolder.getTimeZone().toZoneId())
            .format(DateTimeFormatter.ISO_LOCAL_DATE_TIME);
    }
}
```

### å·¥å…·è³‡æ–™æ¨¡å‹

```java
/**
 * å¤©æ°£æŸ¥è©¢è«‹æ±‚ - ä½¿ç”¨ Record é¡å‹
 */
public record WeatherRequest(
    @JsonProperty("location")
    @JsonPropertyDescription("The location to get weather for (city name, coordinates, etc.)")
    String location,
    
    @JsonProperty("unit")
    @JsonPropertyDescription("Temperature unit: celsius, fahrenheit, or kelvin")
    String unit
) {
    // é è¨­å»ºæ§‹å™¨
    public WeatherRequest {
        if (unit == null) {
            unit = "celsius";
        }
    }
}

/**
 * å¤©æ°£é å ±è«‹æ±‚
 */
public record ForecastRequest(
    @JsonProperty("location")
    @JsonPropertyDescription("The location to get weather forecast for")
    String location,
    
    @JsonProperty("days")
    @JsonPropertyDescription("Number of days for forecast (1-7)")
    Integer days,
    
    @JsonProperty("unit")
    @JsonPropertyDescription("Temperature unit: celsius, fahrenheit, or kelvin")
    String unit
) {
    public ForecastRequest {
        if (days == null) {
            days = 3;
        }
        if (unit == null) {
            unit = "celsius";
        }
    }
}

/**
 * å¤©æ°£è³‡è¨Š
 */
public record WeatherInfo(
    String location,
    String description,
    double temperature,
    double feelsLike,
    int humidity,
    double windSpeed,
    String unit,
    LocalDateTime timestamp
) {}

/**
 * å¤©æ°£é å ±
 */
public record WeatherForecast(
    LocalDate date,
    String description,
    double maxTemperature,
    double minTemperature,
    int humidity,
    double windSpeed,
    String unit
) {}
```

### ChatClient èˆ‡ Tools ä½¿ç”¨ç¤ºä¾‹

```java
/**
 * ChatClient ä½¿ç”¨å¤©æ°£å·¥å…·çš„ç¤ºä¾‹
 */
@Component
@Slf4j
public class WeatherChatExample {
    
    private final ChatClient chatClient;
    private final WeatherTools weatherTools;
    
    public WeatherChatExample(ChatModel chatModel, WeatherTools weatherTools) {
        this.weatherTools = weatherTools;
        this.chatClient = ChatClient.create(chatModel);
    }
    
    /**
     * ä½¿ç”¨ Tools çš„åŸºæœ¬å°è©±
     */
    public String askWeatherQuestion(String question) {
        return chatClient
            .prompt(question)
            .tools(weatherTools) // ç›´æ¥å‚³éå·¥å…·é¡å¯¦ä¾‹
            .call()
            .content();
    }
    
    /**
     * ä½¿ç”¨å¤šå€‹ Tools çš„é€²éšç¤ºä¾‹
     */
    public String complexWeatherQuery(String query) {
        
        // ä½¿ç”¨å¤šå€‹å·¥å…·é¡
        DateTimeTools dateTimeTools = new DateTimeTools();
        
        return chatClient
            .prompt(query)
            .tools(weatherTools, dateTimeTools)
            .call()
            .content();
    }
    
    /**
     * ä½¿ç”¨ Advisors å’Œ Tools çµåˆ
     */
    public String enhancedWeatherChat(String question, String conversationId) {
        
        return ChatClient.builder(chatClient.getChatModel())
            .defaultAdvisors(
                new SimpleLoggerAdvisor(),
                new ReReadingAdvisor()
            )
            .build()
            .prompt(question)
            .advisors(advisor -> advisor.param(ChatMemory.CONVERSATION_ID, conversationId))
            .tools(weatherTools)
            .call()
            .content();
    }
}
```

### æ—¥æœŸæ™‚é–“å·¥å…·é¡

```java
/**
 * æ—¥æœŸæ™‚é–“ç›¸é—œå·¥å…·
 */
@Component
public class DateTimeTools {
    
    @Tool(description = "Get the current date and time in the user's timezone")
    public String getCurrentDateTime() {
        return LocalDateTime.now()
            .atZone(LocaleContextHolder.getTimeZone().toZoneId())
            .toString();
    }
    
    @Tool(description = "Set a user alarm for the given time, provided in ISO-8601 format")
    public String setAlarm(String time) {
        try {
            LocalDateTime alarmTime = LocalDateTime.parse(time, DateTimeFormatter.ISO_DATE_TIME);
            System.out.println("Alarm set for " + alarmTime);
            return "Alarm set successfully for " + alarmTime.format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm"));
        } catch (Exception e) {
            throw new RuntimeException("Invalid time format. Please use ISO-8601 format.", e);
        }
    }
}
/**
 * å¤©æ°£æœå‹™å¯¦ç¾é¡ - ç°¡åŒ–ç‰ˆ
 */
@Service
@Slf4j
public class WeatherService {
    
    private final String apiKey;
    private final String baseUrl;
    private final RestTemplate restTemplate;
    
    public WeatherService(@Value("${weather.api.key}") String apiKey,
                         @Value("${weather.api.baseUrl:https://api.openweathermap.org/data/2.5}") String baseUrl) {
        this.apiKey = apiKey;
        this.baseUrl = baseUrl;
        this.restTemplate = new RestTemplate();
    }
    
    public WeatherInfo getCurrentWeather(String location, String unit) {
        try {
            String url = String.format("%s/weather?q=%s&appid=%s&units=%s",
                baseUrl, location, apiKey, convertUnit(unit));
                
            // ç°¡åŒ–çš„å¯¦ä½œï¼Œå¯¦éš›æ‡‰ç”¨ä¸­æœƒéœ€è¦æ›´å®Œæ•´çš„éŒ¯èª¤è™•ç†
            Map<String, Object> response = restTemplate.getForObject(url, Map.class);
            
            return new WeatherInfo(
                (String) response.get("name"),
                (String) ((Map) ((List) response.get("weather")).get(0)).get("description"),
                ((Number) ((Map) response.get("main")).get("temp")).doubleValue(),
                ((Number) ((Map) response.get("main")).get("feels_like")).doubleValue(),
                ((Number) ((Map) response.get("main")).get("humidity")).intValue(),
                ((Number) ((Map) response.get("wind")).get("speed")).doubleValue(),
                unit,
                LocalDateTime.now()
            );
            
        } catch (Exception e) {
            log.error("Failed to get current weather for: {}", location, e);
            throw new RuntimeException("Weather service error", e);
        }
    }
    
    public List<WeatherForecast> getWeatherForecast(String location, int days, String unit) {
        // ç°¡åŒ–å¯¦ä½œ - å¯¦éš›æ‡‰ç”¨ä¸­æœƒéœ€è¦å®Œæ•´çš„ API èª¿ç”¨å’Œæ•¸æ“šè™•ç†
        List<WeatherForecast> forecasts = new ArrayList<>();
        
        for (int i = 1; i <= days; i++) {
            forecasts.add(new WeatherForecast(
                LocalDate.now().plusDays(i),
                "Partly cloudy",
                25.0 + i, // æ¨¡æ“¬æ•¸æ“š
                15.0 + i,
                60 + i * 2,
                10.5,
                unit
            ));
        }
        
        return forecasts;
    }
    
    private String convertUnit(String unit) {
        if (unit == null) return "metric";
        return switch (unit.toLowerCase()) {
            case "celsius" -> "metric";
            case "fahrenheit" -> "imperial";
            case "kelvin" -> "standard";
            default -> "metric";
        };
    }
}
```

---

## 6.5.5 Spring AI é…ç½®èˆ‡éƒ¨ç½²

### Application é…ç½®æª”æ¡ˆ

```yaml
# application.yml - Spring AI é…ç½®
spring:
  ai:
    openai:
      api-key: ${OPENAI_API_KEY}
      chat:
        options:
          model: gpt-4o-mini
          temperature: 0.7
    
    # å‘é‡è³‡æ–™åº«é…ç½®
    vectordatabase:
      pgvector:
        url: jdbc:postgresql://localhost:5432/vectordb
        username: ${DB_USERNAME}
        password: ${DB_PASSWORD}
        
# å¤©æ°£ API é…ç½®
weather:
  api:
    key: ${WEATHER_API_KEY}
    baseUrl: https://api.openweathermap.org/data/2.5
    timeout: 5000
    retries: 3

# æ‡‰ç”¨ç¨‹åºé…ç½®
logging:
  level:
    org.springframework.ai: DEBUG
    com.example.advisor: DEBUG
    com.example.tools: DEBUG
```

### Spring Boot è‡ªå‹•é…ç½®

```java
/**
 * Spring AI è‡ªå‹•é…ç½®é¡
 */
@Configuration
@EnableConfigurationProperties({WeatherProperties.class})
@Slf4j
public class SpringAIAutoConfiguration {
    
    /**
     * é…ç½® ChatClient Bean
     */
    @Bean
    @ConditionalOnMissingBean
    public ChatClient chatClient(
            ChatModel chatModel,
            @Autowired(required = false) List<Advisor> advisors,
            @Autowired(required = false) ChatMemory chatMemory,
            @Autowired(required = false) VectorStore vectorStore) {
        
        var builder = ChatClient.builder(chatModel);
        
        // è‡ªå‹•è¨»å†Šæ‰€æœ‰å¯ç”¨çš„ Advisors
        if (advisors != null && !advisors.isEmpty()) {
            builder.defaultAdvisors(advisors.toArray(new Advisor[0]));
        }
        
        // è‡ªå‹•æ·»åŠ å¸¸ç”¨çš„ Advisors
        List<Advisor> defaultAdvisors = new ArrayList<>();
        
        if (chatMemory != null) {
            defaultAdvisors.add(MessageChatMemoryAdvisor.builder(chatMemory).build());
        }
        
        if (vectorStore != null) {
            defaultAdvisors.add(QuestionAnswerAdvisor.builder(vectorStore).build());
        }
        
        if (!defaultAdvisors.isEmpty()) {
            builder.defaultAdvisors(defaultAdvisors.toArray(new Advisor[0]));
        }
        
        return builder.build();
    }
    
    /**
     * è‡ªå‹•è¨»å†Šæ‰€æœ‰ Tools
     */
    @Bean
    @ConditionalOnMissingBean
    public ToolCallbackResolver toolCallbackResolver(ApplicationContext applicationContext) {
        return new SpringContextToolCallbackResolver(applicationContext);
    }
    
    /**
     * å¤©æ°£å·¥å…·é…ç½®
     */
    @Bean
    @ConditionalOnProperty(name = "weather.enabled", havingValue = "true", matchIfMissing = true)
    public WeatherTools weatherTools(WeatherService weatherService) {
        return new WeatherTools(weatherService);
    }
    
    /**
     * æ—¥æœŸæ™‚é–“å·¥å…·é…ç½®
     */
    @Bean
    public DateTimeTools dateTimeTools() {
        return new DateTimeTools();
    }
    
    /**
     * è‡ªå®šç¾© Advisors é…ç½®
     */
    @Bean
    @ConditionalOnProperty(name = "spring.ai.advisor.logger.enabled", havingValue = "true", matchIfMissing = true)
    @Order(Ordered.HIGHEST_PRECEDENCE)
    public SimpleLoggerAdvisor simpleLoggerAdvisor() {
        return new SimpleLoggerAdvisor();
    }
    
    @Bean
    @ConditionalOnProperty(name = "spring.ai.advisor.rereading.enabled", havingValue = "true")
    @Order(50)
    public ReReadingAdvisor reReadingAdvisor() {
        return new ReReadingAdvisor();
    }
    
    /**
     * å‘é‡è³‡æ–™åº«é…ç½®
     */
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnProperty(name = "spring.ai.vectordatabase.pgvector.enabled", havingValue = "true")
    public VectorStore vectorStore(@Value("${spring.ai.vectordatabase.pgvector.url}") String url,
                                   @Value("${spring.ai.vectordatabase.pgvector.username}") String username,
                                   @Value("${spring.ai.vectordatabase.pgvector.password}") String password) {
        // PgVector é…ç½®
        return new PgVectorStore(url, username, password);
    }
    
    /**
     * è¨˜æ†¶ç®¡ç†é…ç½®
     */
    @Bean
    @ConditionalOnMissingBean
    @ConditionalOnProperty(name = "spring.ai.chat.memory.enabled", havingValue = "true")
    public ChatMemory chatMemory() {
        return new InMemoryChatMemory();
    }
}

/**
 * å¤©æ°£é…ç½®å±¬æ€§
 */
@ConfigurationProperties(prefix = "weather")
@Data
public class WeatherProperties {
    private Api api = new Api();
    
    @Data
    public static class Api {
        private String key;
        private String baseUrl = "https://api.openweathermap.org/data/2.5";
        private int timeout = 5000;
        private int retries = 3;
    }
}
/**
 * Spring Context Tool Callback Resolver
 */
public class SpringContextToolCallbackResolver implements ToolCallbackResolver {
    
    private final ApplicationContext applicationContext;
    
    public SpringContextToolCallbackResolver(ApplicationContext applicationContext) {
        this.applicationContext = applicationContext;
    }
    
    @Override
    public List<ToolCallback> resolve(String... toolNames) {
        List<ToolCallback> callbacks = new ArrayList<>();
        
        // å¾ Spring ä¸Šä¸‹æ–‡ä¸­è§£æå·¥å…·
        for (String toolName : toolNames) {
            try {
                Object bean = applicationContext.getBean(toolName);
                if (bean != null) {
                    // å°‡ Bean è½‰æ›ç‚º ToolCallback
                    ToolCallback callback = createToolCallbackFromBean(bean);
                    if (callback != null) {
                        callbacks.add(callback);
                    }
                }
            } catch (Exception e) {
                log.warn("Failed to resolve tool: {}", toolName, e);
            }
        }
        
        return callbacks;
    }
    
    private ToolCallback createToolCallbackFromBean(Object bean) {
        // ä½¿ç”¨åå°„å°‡ @Tool è¨»è§£çš„æ–¹æ³•è½‰æ›ç‚º ToolCallback
        return MethodToolCallback.fromObject(bean);
    }
}
```

---

## 6.5.6 å¯¦éš›ä½¿ç”¨ç¤ºä¾‹

### å»ºç«‹å®Œæ•´çš„ AI æ‡‰ç”¨

```java
/**
 * AI åŠ©ç†æ‡‰ç”¨æ§åˆ¶å™¨
 */
@RestController
@RequestMapping("/api/ai")
@RequiredArgsConstructor
@Slf4j
public class AIAssistantController {
    
    private final ChatClient chatClient;
    private final WeatherTools weatherTools;
    private final DateTimeTools dateTimeTools;
    
    /**
     * åŸºæœ¬ AI å°è©±
     */
    @PostMapping("/chat")
    public ResponseEntity<ChatResponse> chat(@RequestBody ChatRequest request) {
        try {
            String response = chatClient
                .prompt(request.getMessage())
                .call()
                .content();
            
            return ResponseEntity.ok(new ChatResponse(response));
        } catch (Exception e) {
            log.error("Chat error", e);
            return ResponseEntity.status(500)
                .body(new ChatResponse("Sorry, I encountered an error: " + e.getMessage()));
        }
    }
    
    /**
     * å®‰è£æ’ä»¶
     */
    @PostMapping("/install")
    public ResponseEntity<ApiResponse> installPlugin(@RequestBody InstallPluginRequest request) {
        try {
            pluginService.installPlugin(request.getPluginPath());
            return ResponseEntity.ok(ApiResponse.success("Plugin installed successfully"));
        } catch (PluginException e) {
            return ResponseEntity.badRequest()
                .body(ApiResponse.error("Plugin installation failed: " + e.getMessage()));
        }
    }
    
    /**
     * å•Ÿç”¨æ’ä»¶
     */
    @PostMapping("/{pluginId}/enable")
    public ResponseEntity<ApiResponse> enablePlugin(@PathVariable String pluginId) {
        try {
            pluginService.enablePlugin(pluginId);
            return ResponseEntity.ok(ApiResponse.success("Plugin enabled successfully"));
        } catch (PluginException e) {
            return ResponseEntity.badRequest()
                .body(ApiResponse.error("Plugin enable failed: " + e.getMessage()));
        }
    }
    
    /**
     * åœç”¨æ’ä»¶
     */
    @PostMapping("/{pluginId}/disable")
    public ResponseEntity<ApiResponse> disablePlugin(@PathVariable String pluginId) {
        try {
            pluginService.disablePlugin(pluginId);
            return ResponseEntity.ok(ApiResponse.success("Plugin disabled successfully"));
        } catch (PluginException e) {
            return ResponseEntity.badRequest()
                .body(ApiResponse.error("Plugin disable failed: " + e.getMessage()));
        }
    }
    
    /**
     * å¸è¼‰æ’ä»¶
     */
    @DeleteMapping("/{pluginId}")
    public ResponseEntity<ApiResponse> uninstallPlugin(@PathVariable String pluginId) {
        try {
            pluginService.uninstallPlugin(pluginId);
            return ResponseEntity.ok(ApiResponse.success("Plugin uninstalled successfully"));
        } catch (PluginException e) {
            return ResponseEntity.badRequest()
                .body(ApiResponse.error("Plugin uninstall failed: " + e.getMessage()));
        }
    }
}
```

---

## ğŸ“ æœ¬ç« é‡é»å›é¡§

1. **æ’ä»¶æ¶æ§‹ç†è§£**ï¼šæŒæ¡äº† Spring AI æ’ä»¶ç³»çµ±çš„è¨­è¨ˆåŸç†å’Œæ¶æ§‹æ¨¡å¼
2. **æ’ä»¶é–‹ç™¼å¯¦è¸**ï¼šå®Œæˆäº†å¾åŸºç¤æ¡†æ¶åˆ°å¯¦éš›æ’ä»¶çš„å®Œæ•´é–‹ç™¼æµç¨‹
3. **ç”Ÿå‘½é€±æœŸç®¡ç†**ï¼šå¯¦ç¾äº†æ’ä»¶çš„è¼‰å…¥ã€åˆå§‹åŒ–ã€å•Ÿå‹•ã€åœæ­¢å’Œå¸è¼‰æ©Ÿåˆ¶
4. **é…ç½®ç®¡ç†ç³»çµ±**ï¼šå»ºç«‹äº†å®Œæ•´çš„æ’ä»¶é…ç½®å’Œç®¡ç†é«”ç³»
5. **REST API æ•´åˆ**ï¼šæä¾›äº†æ’ä»¶ç®¡ç†çš„ Web ä»‹é¢å’Œ API

### æŠ€è¡“è¦é»ç¸½çµ

| æŠ€è¡“é» | é‡è¦æ€§ | å¯¦ç¾é›£åº¦ | ä¼æ¥­åƒ¹å€¼ |
|--------|--------|----------|----------|
| **æ’ä»¶æ¶æ§‹è¨­è¨ˆ** | â­â­â­ | é«˜ | ç³»çµ±æ“´å±•æ€§ |
| **ç”Ÿå‘½é€±æœŸç®¡ç†** | â­â­â­ | é«˜ | ç©©å®šæ€§ä¿è­‰ |
| **é…ç½®ç®¡ç†** | â­â­ | ä¸­ | æ˜“ç”¨æ€§æå‡ |
| **REST API æ•´åˆ** | â­â­ | ä¸­ | ç®¡ç†ä¾¿åˆ©æ€§ |
| **ä¾è³´ç®¡ç†** | â­â­ | é«˜ | ç³»çµ±å¯é æ€§ |

### æœ€ä½³å¯¦è¸å»ºè­°

1. **è¨­è¨ˆåŸå‰‡**ï¼šéµå¾ªå–®ä¸€è·è²¬å’Œé–‹æ”¾å°é–‰åŸå‰‡ï¼Œç¢ºä¿æ’ä»¶çš„ç¨ç«‹æ€§å’Œå¯æ“´å±•æ€§
2. **éŒ¯èª¤è™•ç†**ï¼šå¯¦ç¾å®Œå–„çš„éŒ¯èª¤è™•ç†å’Œæ¢å¾©æ©Ÿåˆ¶ï¼Œé¿å…æ’ä»¶éŒ¯èª¤å½±éŸ¿ç³»çµ±ç©©å®šæ€§
3. **å®‰å…¨è€ƒé‡**ï¼šå»ºç«‹æ’ä»¶æ¬Šé™ç®¡ç†å’Œå®‰å…¨æª¢æŸ¥æ©Ÿåˆ¶ï¼Œé˜²æ­¢æƒ¡æ„æ’ä»¶
4. **æ•ˆèƒ½å„ªåŒ–**ï¼šä½¿ç”¨å»¶é²è¼‰å…¥å’Œè³‡æºæ± åŒ–æŠ€è¡“ï¼Œæå‡æ’ä»¶ç³»çµ±æ•ˆèƒ½
5. **æ–‡æª”è¦ç¯„**ï¼šå»ºç«‹å®Œæ•´çš„æ’ä»¶é–‹ç™¼æ–‡æª”å’Œè¦ç¯„ï¼Œé™ä½é–‹ç™¼é–€æª»

### ä¸‹ä¸€æ­¥å­¸ç¿’æ–¹å‘

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘å€‘å°‡å­¸ç¿’å¦‚ä½•å®‰è£å’Œé…ç½® Neo4j å‘é‡è³‡æ–™åº«ï¼ŒåŒ…æ‹¬ï¼š
- Neo4j çš„å®‰è£å’ŒåŸºæœ¬é…ç½®
- å‘é‡è³‡æ–™åº«çš„æ¦‚å¿µå’Œæ‡‰ç”¨
- èˆ‡ Spring AI çš„æ•´åˆé…ç½®
- Docker å®¹å™¨åŒ–éƒ¨ç½²

---

**åƒè€ƒè³‡æ–™ï¼š**
- [Spring Plugin Framework](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-java)
- [Java Plugin Architecture](https://www.baeldung.com/java-plugin-system)
- [OSGi Bundle Development](https://www.osgi.org/developer/)
- [Spring Boot Auto Configuration](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.developing-auto-configuration)