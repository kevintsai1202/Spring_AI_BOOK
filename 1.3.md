# 1.3 æ ¸å¿ƒè¨»è§£èˆ‡ä¾è³´æ³¨å…¥

> **æœ¬ç« é‡é»**ï¼šæŒæ¡ Spring Boot æ ¸å¿ƒè¨»è§£é«”ç³»å’Œä¾è³´æ³¨å…¥æ©Ÿåˆ¶ï¼Œç‚º Spring AI æ‡‰ç”¨é–‹ç™¼å»ºç«‹å …å¯¦çš„æŠ€è¡“åŸºç¤ã€‚

## ğŸ¯ å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬ç« å­¸ç¿’å¾Œï¼Œæ‚¨å°‡èƒ½å¤ ï¼š

- ğŸ¯ **æŒæ¡æ ¸å¿ƒè¨»è§£**ï¼šç†Ÿç·´ä½¿ç”¨ @SpringBootApplicationã€@RestControllerã€@Service ç­‰åŸºç¤è¨»è§£
- ğŸ¯ **ç†è§£ä¾è³´æ³¨å…¥**ï¼šæŒæ¡ @Autowired å’Œæ§‹é€ å‡½æ•¸æ³¨å…¥çš„ä½¿ç”¨æ–¹æ³•
- ğŸ¯ **å¯¦ç¾çµ„ä»¶ç®¡ç†**ï¼šä½¿ç”¨ Spring å®¹å™¨ç®¡ç†æ‡‰ç”¨ç¨‹å¼çµ„ä»¶
- ğŸ¯ **å»ºç«‹åˆ†å±¤æ¶æ§‹**ï¼šé‹ç”¨è¨»è§£å»ºç«‹æ¸…æ™°çš„åˆ†å±¤æ¶æ§‹
- ğŸ¯ **ç‚º AI æœå‹™åšæº–å‚™**ï¼šæŒæ¡ AI æ‡‰ç”¨é–‹ç™¼æ‰€éœ€çš„æ ¸å¿ƒè¨»è§£æŠ€èƒ½

---

## 1.3.1 Spring Boot è¨»è§£é«”ç³»æ¦‚è¦½

### è¨»è§£åˆ†é¡

Spring Boot çš„è¨»è§£å¯ä»¥åˆ†ç‚ºä»¥ä¸‹å¹¾å€‹æ ¸å¿ƒé¡åˆ¥ï¼š

| é¡åˆ¥ | ç”¨é€” | æ ¸å¿ƒè¨»è§£ | AI æ‡‰ç”¨é‡è¦æ€§ |
|------|------|----------|---------------|
| **å•Ÿå‹•è¨»è§£** | æ‡‰ç”¨ç¨‹å¼å•Ÿå‹• | `@SpringBootApplication` | â­â­â­ |
| **çµ„ä»¶è¨»è§£** | å®šç¾©å’Œç®¡ç† Bean | `@Component`ã€`@Service`ã€`@RestController` | â­â­â­ |
| **ä¾è³´æ³¨å…¥** | è™•ç†ä¾è³´é—œä¿‚ | `@Autowired` | â­â­â­ |
| **Web è¨»è§£** | API é–‹ç™¼ | `@RequestMapping`ã€`@GetMapping`ã€`@PostMapping` | â­â­â­ |
| **é…ç½®è¨»è§£** | é…ç½®ç®¡ç† | `@Value`ã€`@ConfigurationProperties` | â­â­ |

---

## 1.3.2 æ ¸å¿ƒå•Ÿå‹•è¨»è§£

### @SpringBootApplication

é€™æ˜¯ Spring Boot æœ€é‡è¦çš„è¨»è§£ï¼Œå®ƒæ˜¯ä¸€å€‹**çµ„åˆè¨»è§£**ï¼š

```java
@SpringBootApplication
public class DemoApplication {
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }
}
```

**@SpringBootApplication ç­‰åŒæ–¼**ï¼š
```java
@SpringBootConfiguration  // ç­‰åŒæ–¼ @Configuration
@EnableAutoConfiguration  // å•Ÿç”¨è‡ªå‹•é…ç½®
@ComponentScan           // å•Ÿç”¨çµ„ä»¶æƒæ
public class DemoApplication {
    // ...
}
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- **è‡ªå‹•é…ç½®**ï¼šæ ¹æ“š classpath è‡ªå‹•é…ç½® Spring æ‡‰ç”¨
- **çµ„ä»¶æƒæ**ï¼šè‡ªå‹•æƒæä¸¦è¨»å†Š Spring çµ„ä»¶
- **é…ç½®é¡åˆ¥**ï¼šå°‡ä¸»é¡åˆ¥æ¨™è¨˜ç‚ºé…ç½®é¡åˆ¥

---

## 1.3.3 çµ„ä»¶è¨»è§£

### @Component ç³»åˆ—è¨»è§£

**åŸºç¤çµ„ä»¶è¨»è§£**ï¼š
```java
// é€šç”¨çµ„ä»¶
@Component
public class DataProcessor {
    public String process(String data) {
        return "Processed: " + data;
    }
}
```

**å°ˆç”¨çµ„ä»¶è¨»è§£**ï¼š

**1. @Service - æ¥­å‹™é‚è¼¯å±¤**
```java
@Service
public class UserService {
    
    public List<User> getAllUsers() {
        // æ¥­å‹™é‚è¼¯å¯¦ç¾
        return Arrays.asList(
            new User(1L, "Alice", "alice@example.com"),
            new User(2L, "Bob", "bob@example.com")
        );
    }
    
    public User createUser(String name, String email) {
        // å»ºç«‹ä½¿ç”¨è€…çš„æ¥­å‹™é‚è¼¯
        return new User(System.currentTimeMillis(), name, email);
    }
}
```

**2. @RestController - API æ§åˆ¶å™¨**
```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    private final UserService userService;
    
    // æ§‹é€ å‡½æ•¸æ³¨å…¥ï¼ˆæ¨è–¦æ–¹å¼ï¼‰
    public UserController(UserService userService) {
        this.userService = userService;
    }
    
    @GetMapping
    public List<User> getUsers() {
        return userService.getAllUsers();
    }
    
    @PostMapping
    public User createUser(@RequestBody CreateUserRequest request) {
        return userService.createUser(request.getName(), request.getEmail());
    }
}
```

**3. @Repository - è³‡æ–™å­˜å–å±¤**
```java
@Repository
public class UserRepository {
    
    private final List<User> users = new ArrayList<>();
    
    public List<User> findAll() {
        return new ArrayList<>(users);
    }
    
    public User save(User user) {
        users.add(user);
        return user;
    }
    
    public Optional<User> findById(Long id) {
        return users.stream()
                .filter(user -> user.getId().equals(id))
                .findFirst();
    }
}
```

---

## 1.3.4 ä¾è³´æ³¨å…¥

### ç‚ºä»€éº¼éœ€è¦ä¾è³´æ³¨å…¥ï¼Ÿ

**æ²’æœ‰ä¾è³´æ³¨å…¥çš„å•é¡Œ**ï¼š
```java
// âŒ ç·Šå¯†è€¦åˆçš„ç¨‹å¼ç¢¼
public class UserController {
    private UserService userService = new UserService(); // ç¡¬ç·¨ç¢¼ä¾è³´
    
    // é›£ä»¥æ¸¬è©¦ã€é›£ä»¥æ“´å±•
}
```

**ä½¿ç”¨ä¾è³´æ³¨å…¥çš„å„ªå‹¢**ï¼š
```java
// âœ… é¬†æ•£è€¦åˆçš„ç¨‹å¼ç¢¼
@RestController
public class UserController {
    private final UserService userService;
    
    // Spring è‡ªå‹•æ³¨å…¥ä¾è³´
    public UserController(UserService userService) {
        this.userService = userService;
    }
    
    // æ˜“æ–¼æ¸¬è©¦ã€æ˜“æ–¼æ“´å±•
}
```

### ä¾è³´æ³¨å…¥æ–¹å¼

**1. æ§‹é€ å‡½æ•¸æ³¨å…¥ï¼ˆæ¨è–¦ï¼‰**
```java
@RestController
public class UserController {
    
    private final UserService userService;
    private final EmailService emailService;
    
    // æ§‹é€ å‡½æ•¸æ³¨å…¥ - æ¨è–¦æ–¹å¼
    public UserController(UserService userService, EmailService emailService) {
        this.userService = userService;
        this.emailService = emailService;
    }
}
```

**å„ªå‹¢**ï¼š
- ç¢ºä¿ä¾è³´ä¸ç‚º null
- æ”¯æ´ final æ¬„ä½
- ä¾¿æ–¼å–®å…ƒæ¸¬è©¦
- æ˜ç¢ºè¡¨é”ä¾è³´é—œä¿‚

**2. @Autowired æ¬„ä½æ³¨å…¥**
```java
@RestController
public class UserController {
    
    @Autowired
    private UserService userService;
    
    @Autowired
    private EmailService emailService;
    
    // ç°¡æ½”ä½†ä¸æ¨è–¦ç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒ
}
```

**3. Setter æ³¨å…¥**
```java
@RestController
public class UserController {
    
    private UserService userService;
    
    @Autowired
    public void setUserService(UserService userService) {
        this.userService = userService;
    }
}
```

---

## 1.3.5 Web é–‹ç™¼æ ¸å¿ƒè¨»è§£

### HTTP æ–¹æ³•è¨»è§£

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    private final UserService userService;
    
    public UserController(UserService userService) {
        this.userService = userService;
    }
    
    // GET è«‹æ±‚ - ç²å–æ‰€æœ‰ä½¿ç”¨è€…
    @GetMapping
    public List<User> getAllUsers() {
        return userService.getAllUsers();
    }
    
    // GET è«‹æ±‚ - æ ¹æ“š ID ç²å–ä½¿ç”¨è€…
    @GetMapping("/{id}")
    public User getUserById(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    // POST è«‹æ±‚ - å»ºç«‹æ–°ä½¿ç”¨è€…
    @PostMapping
    public User createUser(@RequestBody CreateUserRequest request) {
        return userService.createUser(request);
    }
    
    // PUT è«‹æ±‚ - æ›´æ–°ä½¿ç”¨è€…
    @PutMapping("/{id}")
    public User updateUser(@PathVariable Long id, @RequestBody UpdateUserRequest request) {
        return userService.updateUser(id, request);
    }
    
    // DELETE è«‹æ±‚ - åˆªé™¤ä½¿ç”¨è€…
    @DeleteMapping("/{id}")
    public void deleteUser(@PathVariable Long id) {
        userService.deleteUser(id);
    }
}
```

### åƒæ•¸ç¶å®šè¨»è§£

```java
@RestController
@RequestMapping("/api/search")
public class SearchController {
    
    // è·¯å¾‘è®Šæ•¸
    @GetMapping("/users/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    // æŸ¥è©¢åƒæ•¸
    @GetMapping("/users")
    public List<User> searchUsers(
            @RequestParam(required = false) String name,
            @RequestParam(defaultValue = "0") int page,
            @RequestParam(defaultValue = "10") int size) {
        return userService.search(name, page, size);
    }
    
    // è«‹æ±‚é«”
    @PostMapping("/users")
    public User createUser(@RequestBody CreateUserRequest request) {
        return userService.createUser(request);
    }
    
    // è«‹æ±‚æ¨™é ­
    @GetMapping("/profile")
    public User getCurrentUser(@RequestHeader("Authorization") String token) {
        return userService.findByToken(token);
    }
}
```

---

## 1.3.6 é…ç½®ç›¸é—œè¨»è§£

### @Value - å±¬æ€§æ³¨å…¥

```java
@Service
public class ConfigService {
    
    @Value("${app.name:Default App}")
    private String appName;
    
    @Value("${app.version:1.0.0}")
    private String appVersion;
    
    @Value("${app.max-users:100}")
    private int maxUsers;
    
    public String getAppInfo() {
        return String.format("%s v%s (Max Users: %d)", appName, appVersion, maxUsers);
    }
}
```

### @ConfigurationProperties - é¡å‹å®‰å…¨é…ç½®

```java
@ConfigurationProperties(prefix = "app")
@Component
public class AppProperties {
    
    private String name = "Default App";
    private String version = "1.0.0";
    private int maxUsers = 100;
    private Database database = new Database();
    
    // Getters and Setters
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    public String getVersion() { return version; }
    public void setVersion(String version) { this.version = version; }
    
    public int getMaxUsers() { return maxUsers; }
    public void setMaxUsers(int maxUsers) { this.maxUsers = maxUsers; }
    
    public Database getDatabase() { return database; }
    public void setDatabase(Database database) { this.database = database; }
    
    public static class Database {
        private String url = "jdbc:h2:mem:testdb";
        private String username = "sa";
        private String password = "";
        
        // Getters and Setters
        public String getUrl() { return url; }
        public void setUrl(String url) { this.url = url; }
        
        public String getUsername() { return username; }
        public void setUsername(String username) { this.username = username; }
        
        public String getPassword() { return password; }
        public void setPassword(String password) { this.password = password; }
    }
}
```

**å°æ‡‰çš„ application.yml**ï¼š
```yaml
app:
  name: Spring Boot Demo
  version: 2.0.0
  max-users: 500
  database:
    url: jdbc:mysql://localhost:3306/demo
    username: demo_user
    password: demo_pass
```

---

## 1.3.7 ç‚º Spring AI åšæº–å‚™

### AI æœå‹™çš„è¨»è§£æ¨¡å¼

```java
// AI æœå‹™å±¤
@Service
public class AIService {
    
    @Value("${ai.openai.api-key}")
    private String apiKey;
    
    @Value("${ai.openai.model:gpt-3.5-turbo}")
    private String model;
    
    public String chat(String message) {
        // é ç•™çµ¦ Spring AI æ•´åˆ
        return "AI Response: " + message;
    }
}

// AI æ§åˆ¶å™¨
@RestController
@RequestMapping("/api/ai")
public class AIController {
    
    private final AIService aiService;
    
    public AIController(AIService aiService) {
        this.aiService = aiService;
    }
    
    @PostMapping("/chat")
    public ResponseEntity<String> chat(@RequestBody ChatRequest request) {
        String response = aiService.chat(request.getMessage());
        return ResponseEntity.ok(response);
    }
}

// AI é…ç½®é¡åˆ¥
@ConfigurationProperties(prefix = "ai")
@Component
public class AIProperties {
    
    private OpenAI openai = new OpenAI();
    
    public OpenAI getOpenai() { return openai; }
    public void setOpenai(OpenAI openai) { this.openai = openai; }
    
    public static class OpenAI {
        private String apiKey;
        private String model = "gpt-3.5-turbo";
        private int maxTokens = 1000;
        private double temperature = 0.7;
        
        // Getters and Setters
    }
}
```

### å¯¦ç”¨çš„è¨»è§£çµ„åˆ

```java
// å®Œæ•´çš„ AI æ‡‰ç”¨ç¯„ä¾‹
@RestController
@RequestMapping("/api/ai")
public class AIApplicationController {
    
    private final AIService aiService;
    private final UserService userService;
    
    // æ§‹é€ å‡½æ•¸æ³¨å…¥å¤šå€‹æœå‹™
    public AIApplicationController(AIService aiService, UserService userService) {
        this.aiService = aiService;
        this.userService = userService;
    }
    
    @PostMapping("/analyze")
    public ResponseEntity<AnalysisResult> analyzeUserData(
            @PathVariable Long userId,
            @RequestBody AnalysisRequest request,
            @RequestHeader("Authorization") String token) {
        
        // é©—è­‰ä½¿ç”¨è€…
        User user = userService.findById(userId);
        
        // AI åˆ†æ
        AnalysisResult result = aiService.analyze(user, request);
        
        return ResponseEntity.ok(result);
    }
}
```

---

## ğŸ“ æœ¬ç« é‡é»å›é¡§

1. **æ ¸å¿ƒè¨»è§£æŒæ¡**ï¼šå­¸æœƒäº† @SpringBootApplicationã€@RestControllerã€@Service ç­‰åŸºç¤è¨»è§£
2. **ä¾è³´æ³¨å…¥ç†è§£**ï¼šæŒæ¡äº†æ§‹é€ å‡½æ•¸æ³¨å…¥å’Œ @Autowired çš„ä½¿ç”¨æ–¹æ³•
3. **Web é–‹ç™¼è¨»è§£**ï¼šç†Ÿæ‚‰äº† HTTP æ–¹æ³•è¨»è§£å’Œåƒæ•¸ç¶å®šè¨»è§£
4. **é…ç½®ç®¡ç†**ï¼šå­¸æœƒäº†ä½¿ç”¨ @Value å’Œ @ConfigurationProperties ç®¡ç†é…ç½®
5. **AI æ•´åˆæº–å‚™**ï¼šç‚º Spring AI æ‡‰ç”¨é–‹ç™¼å»ºç«‹äº†è¨»è§£ä½¿ç”¨åŸºç¤

### ä¸‹ä¸€æ­¥å­¸ç¿’æ–¹å‘

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘å€‘å°‡å»ºç«‹ç¬¬ä¸€å€‹å®Œæ•´çš„ Spring Boot æ‡‰ç”¨ï¼Œå¯¦éš›é‹ç”¨é€™äº›è¨»è§£ä¾†é–‹ç™¼ä¸€å€‹ä½¿ç”¨è€…ç®¡ç†ç³»çµ±ã€‚

---

**åƒè€ƒè³‡æ–™ï¼š**
- [Spring Boot Annotations](https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.auto-configuration)
- [Spring Framework Core](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html)
- [Dependency Injection](https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-dependencies)